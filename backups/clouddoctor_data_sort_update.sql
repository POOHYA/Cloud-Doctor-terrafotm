--
-- PostgreSQL database dump
--

-- Dumped from database version 15.14 (Debian 15.14-1.pgdg13+1)
-- Dumped by pg_dump version 15.14 (Debian 15.14-1.pgdg13+1)

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- Data for Name: cloud_providers; Type: TABLE DATA; Schema: public; Owner: -
--

INSERT INTO public.cloud_providers VALUES (1, 'AWS', 'Amazon Web Services', true, '2025-10-19 20:14:48.937168');
INSERT INTO public.cloud_providers VALUES (2, 'GCP', 'Google Cloud Platform', true, '2025-10-19 20:14:48.937168');
INSERT INTO public.cloud_providers VALUES (3, 'Azure', 'Microsoft Azure', true, '2025-10-19 20:14:48.937168');


--
-- Data for Name: service_lists; Type: TABLE DATA; Schema: public; Owner: -
--

INSERT INTO public.service_lists VALUES (1, 1, 'ec2', 'Amazon EC2', 41, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (2, 1, 's3', 'Amazon S3', 20, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (3, 1, 'iam', 'AWS IAM', 152, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (4, 1, 'vpc', 'Amazon VPC', 5, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (5, 1, 'lambda', 'AWS Lambda', 5, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (6, 1, 'rds', 'Amazon RDS', 6, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (7, 1, 'cloudtrail', 'AWS CloudTrail', 5, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (8, 1, 'eks', 'Amazon EKS', 7, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (9, 1, 'kms', 'AWS KMS', 3, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (10, 1, 'sns', 'Amazon SNS', 3, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (11, 1, 'sqs', 'Amazon SQS', 2, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (12, 1, 'route53', 'Amazon Route 53', 7, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (13, 1, 'organizations', 'AWS Organizations', 4, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (14, 1, 'ecr', 'Amazon ECR', 3, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (15, 1, 'ssm', 'AWS Systems Manager', 4, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (16, 1, 'guardduty', 'Amazon GuardDuty', 3, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (17, 1, 'cognito', 'Amazon Cognito', 9, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (18, 1, 'cloudformation', 'AWS CloudFormation', 4, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (19, 1, 'opensearch', 'AWS OpenSearch Service', 2, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (20, 1, 'elasticbeanstalk', 'AWS Elastic Beanstalk', 3, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (21, 1, 'redshift', 'Amazon Redshift', 2, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (22, 1, 'glue', 'AWS Glue', 3, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (23, 1, 'servicecatalog', 'AWS Service Catalog', 3, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (24, 1, 'documentdb', 'Amazon DocumentDB', 2, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (25, 1, 'bedrock', 'Amazon Bedrock', 4, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (26, 1, 'ses', 'Amazon SES', 2, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');
INSERT INTO public.service_lists VALUES (27, 1, 'appstream', 'Amazon AppStream 2.0', 2, true, '2025-10-19 20:14:48.937168', '2025-10-19 20:14:48.937168');


--
-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: -
--

INSERT INTO public.users VALUES (1, 'user', 'user@naver.com', '$2a$10$SXGlY5BaiIpFkdSFLAN/x.mLWwicxrXHg6cRNWRoXs0yS/WxocF6K', '안녕', '케이쉴드', 'USER', '1760873550845-01f295be-2da1-49e1-81c2-c67d2bfc33f9', '2025-10-19 20:32:30.859185', '2025-10-19 20:32:30.859185', true, false, NULL);
INSERT INTO public.users VALUES (2, 'admin1', 'admin1@admin', '$2a$10$GUkG6f7ey1zf/JDBHWgS7OBupqKe2oCvXsO90qwj3F9NNQSJjlKQK', 'admin1', '', 'ADMIN', '1760876730894-4cd4c497-fc94-465f-ace3-be5ed1f87697', '2025-10-19 21:25:30.895057', '2025-10-19 21:25:30.895057', true, false, NULL);
INSERT INTO public.users VALUES (3, 'admin2', 'admin2@admin', '$2a$10$mYggT92Aipf3wzGRq1umJeIMy3/fvlM3Hg75kn9H5jtFQPq/jSDb6', 'admin2', '', 'ADMIN', '1760876747531-56f366a8-b9e7-43be-a923-abd23199a5b4', '2025-10-19 21:25:47.531852', '2025-10-19 21:25:47.531852', true, false, NULL);
INSERT INTO public.users VALUES (4, 'admin3', 'admin3@admin', '$2a$10$aj83kH6BuNu5/Xaa8JqFROkF12B6A92BYu7vsD/v2FrVsKMGQ.R1i', 'admin3', '', 'ADMIN', '1760876762324-ed42337b-bcbb-4c4b-81aa-7dc771d0b909', '2025-10-19 21:26:02.324708', '2025-10-19 21:26:02.324708', true, false, NULL);
INSERT INTO public.users VALUES (5, 'hyo', 'h1@naver.com', '$2a$10$gfKcIM0G/PuexOplmjSTWeRyTFn9Y/bUiraFHp1/dREvtqOLvCPDC', '김', '', 'USER', '1760899013542-9a8074b9-1b21-4924-869c-dfb83b184702', '2025-10-20 03:36:53.54902', '2025-10-20 03:36:53.54902', true, false, NULL);
INSERT INTO public.users VALUES (6, 'lee', 'r@naver.com', '$2a$10$TEc98kM5UhUJsH8BrLqqM.gLlvGav4QqliMA309G7T/0VWpzd/s3y', '이', '', 'USER', '1760934982165-b310a470-30c6-45bc-8684-9fc9402d716e', '2025-10-20 13:36:22.168798', '2025-10-20 13:36:22.168798', true, false, NULL);


--
-- Data for Name: guidelines; Type: TABLE DATA; Schema: public; Owner: -
--

INSERT INTO public.guidelines VALUES (1, 'IMDS 보안 통제 미적용으로 인한 임시 자격증명 탈취', 1, 1, '중요', 'IMDS(Instance Metadata Service)는 AWS에서 실행되는 EC2 인스턴스가 메타데이터 및 사용자 데이터를 조회할 수 있는 서비스입니다. IMDS 접근이 통제되지 않으면 단 한 번의 취약점으로도 임시 자격증명이 탈취되어 계정 전체가 악용될 수 있습니다.
특히 IMDS가 오래된 버전(IMDSv1)으로 남아 있거나, 인스턴스 역할에 권한이 과도하게 주어져 있으면 피해 규모가 커질 수 있습니다.', '공격자가 웹/앱의 취약점을 이용해 IMDS를 호출하면, 인스턴스에 부여된 IAM 역할의 임시 자격증명(AccessKey, Secret, Token)을 얻을 수 있습니다. 탈취된 자격증명은 S3, EC2, IAM 등 권한 범위 내 AWS API 호출에 사용되어 데이터 탈취, 권한 상승, 백도어 생성과 같은 추가 공격으로 이어집니다.', '🧭 EC2 → 인스턴스 → 해당 인스턴스 → 작업 → 인스턴스 설정 → 인스턴스 메타데이터의 태그 허용
 ↳ ⚠️ IMDSv2가 Optional로 설정되어 있으면 취약합니다.', '1️⃣ EC2 → 인스턴스 → 해당 인스턴스 → 작업 → 인스턴스 설정 → 인스턴스 메타데이터의 태그 허용
 - 모든 EC2 인스턴스에서 IMDSv2를 필수로 설정해야 합니다.', '', '', '2025-10-19 21:33:02.731077', '2025-10-19 21:36:06.115629', 2);
INSERT INTO public.guidelines VALUES (2, 'EC2 User Data 내 민감 정보 관리 미흡', 1, 1, '중요', 'EC2 User Data는 EC2 인스턴스가 처음 시작될 때 자동으로 실행되는 스크립트입니다. 부팅 시 루트 권한으로 실행되며 스크립트에 DB 비밀번호, API 키 같은 민감 정보가 평문으로 들어가 있으므로 누구든 쉽게 조회하거나 탈취할 수 있습니다.
User Data에 민감 정보가 포함되어 있는 경우, 공격자는 이를 탈취 후 다른 서비스에서 크리덴셜 스터핑과 같은 공격에 악용할 수 있습니다.', '공격자는 탈취한 민감 정보로 S3, RDS, IAM 등 클라우드 리소스에 접근할 수 있습니다. 이는 곧 대규모 데이터 유출, 권한 상승으로 이어져 서비스 중단, 데이터 손실, 랜섬웨어 감염 및 평판/법적 피해 등 심각한 운영 리스크를 초래할 수 있습니다.', '🧭 EC2 → 인스턴스 → 작업 → 인스턴스 설정 → 사용자 데이터 편집
 ↳ ⚠️User Data(부팅 스크립트)에 password, passwd, secret, api_key, apikey, access_key, AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY, DB_PASSWORD 등 민감 키워드 또는 실제 평문 자격증명이 포함되어 있으면 취약합니다.', '1️⃣ AWS Systems Manager → 파라미터 스토어 → 파라미터 생성
 - 파라미터 생성 시, 유형을 보안 문자열(SecureString)로 선택해야 합니다.
 - 유형이 ''SecureString''으로 지정되었고, 실제 값은 암호화되어 별표(****)로 마스킹 처리되어야 합니다.', '인스턴스 부팅 시 외부 시크릿 저장소(SSM/KMS)에 의존하게 되어 초기화가 지연되거나 부팅에 실패할 수 있습니다.', '', '2025-10-19 21:35:48.793997', '2025-10-19 21:35:48.793997', 2);
INSERT INTO public.guidelines VALUES (3, 'AMI 공개 설정으로 인한 정보 노출', 1, 1, '긴급', 'AMI(Amazon Machine Image) 원본 이미지를 퍼블릭으로 설정하는 것은 전 세계 누구나 이 이미지를 가져가서 자신의 서버를 만들 수 있도록 완전히 공개하는 것을 의미합니다.
실수로 개발/테스트 과정에서 사용했던 비밀번호, 인증 키(AWS Access Key), 설정 파일, 개인 키(SSH Key), 또는 소스 코드 같은 정보가 이미지 안에 남아 있다면, 공격자는 공개된 AMI를 복사해서 내부 정보를 통째로 훔쳐갈 수 있습니다.', '공격자는 공개된 AMI를 다운로드하여 이미지 내부를 분석하고, 그 안에 하드코딩된 민감정보를 찾아냅니다. 이 탈취한 키를 이용해 공격자는 내 AWS 계정 내 다른 서버나 데이터베이스, 저장소에 접근하여 중요 데이터를 유출하거나 삭제할 수 있습니다.
또한 오래된 취약점이 포함된 AMI를 통해 공격자는 손쉽게 악성 코드를 심거나 이미 감염된 이미지를 배포하여 더 큰 네트워크 침해로 이어질 수 있습니다.', '🧭 EC2 → 이미지 → AMI → 공개하려는 AMI 선택 → 작업 → AMI 권한 편집 → AMI 공유 설정 
 ↳ ⚠️ Public 여부를 확인하여 운영 AMI가 Public이라면 취약합니다.', '1️⃣ EC2 → 이미지 → AMI → 공개하려는 AMI 선택 → 작업 → AMI 권한 편집 → AMI 공유 설정 
 - AMI 가용성을 확인하여 프라이빗으로 설정합니다.', '타계정 배포 및 협력사 공유가 복잡해지고 지연될 수 있으며, 권한 또는 의존성 관련 오류가 발생할 수 있습니다.', '', '2025-10-19 21:37:23.506195', '2025-10-19 21:37:23.506195', 2);
INSERT INTO public.guidelines VALUES (4, 'AMI owner 속성 미설정시 위험성', 1, 1, '중요', 'AWS에서 서버를 자동으로 배포하기 위해 Terraform 같은 도구를 사용할 때, 보통 특정 AMI 소유자(Owner)를 지정하지 않고 ''가장 최신(most_recent)'' AMI를 사용하도록 설정하는 경우가 있습니다. 이 설정이 위험한 이유는, 공격자가 악의적인 목적을 가진 AMI를 만들어서 계정에서 사용하는 Owner와 동일한 AMI 이름으로 등록한 뒤, 그 AMI가 ‘가장 최신''인 것처럼 보이게 할 수 있기 때문입니다.
자동 배포 시스템은 소유자를 확인하지 않고 가장 최신인 그 악성 AMI를 선택하게 되고, 결국 공격자가 만든 서버 이미지가 시스템에 배포될 수 있습니다.', '시스템에 공격자가 만든 악성 AMI가 배포되면, 이 서버는 부팅되는 순간부터 공격자의 통제하에 놓입니다. 공격자는 이 서버를 발판 삼아 AWS 내부 네트워크에 침투할 수 있으며, 이 서버가 가진 권한을 이용해 내부 자격증명을 훔치거나 다른 서버를 공격할 수 있습니다.
결과적으로 공격자는 서비스 자원을 마음대로 사용하거나, 서버를 통해 개인정보를 탈취하는 등 심각한 피해를 입힐 수 있습니다.', '🧭 AWS Organazations → 정책 → 서비스 제어 정책 → 새 서비스 제어 정책 생성
 ↳ ⚠️AMI 소유자 제한(Allowed AMIs) 가드레일이 없으면 취약합니다.', '1️⃣ AWS Organazations → 정책 → 서비스 제어 정책 → 새 서비스 제어 정책 생성
 - AMI 이미지 허용 목록(allow list)에 등록된 계정의 AMI만 사용되도록 조직 가드레일을 적용해야 합니다.', '공식/서드파티/신규 AMI 배포가 실패하거나 복구/테스트가 지연될 수 있습니다.', '', '2025-10-19 21:38:40.38798', '2025-10-19 21:38:40.38798', 2);
INSERT INTO public.guidelines VALUES (5, 'Public으로 공개된 SSH/RDP를 통한 자원 탈취', 1, 1, '확인요망', 'RDP는 기본적으로 외부에서 접근 가능하도록 설정되어 있는 경우가 많아, 공격자가 이를 악용하여 클라우드 인프라를 침해할 수 있습니다.
퍼블릭에 노출된 SSH(포트 22)/RDP(포트 3389)는 브루트포스, 공개된 취약점, 약한 비밀번호, 재사용된 크리덴셜에 의해 쉽게 탈취될 수 있으므로 인스턴스가 초기에 기동된 후 공격자에게 루트/관리자 권한을 제공할 수 있습니다.', '공격자는 열린 SSH나 RDP 포트로 EC2 내부에 침입해 자격증명 수집, 횡적 이동, 권한 상승 등을 통해 클라우드 자원을 탈취할 수 있습니다. 탈취된 인스턴스는 즉시 암호화폐 채굴, 스캔/확산, 자격증명 수집, 백도어 설치 등 공격자의 영구적이고 광범위한 자원 악용 수단이 됩니다.
결과적으로 조직은 예상치 못한 비용 부담과 서비스 안정성 저하, 장기적인 보안 위협에 노출될 수 있습니다.', '🧭 VPC → 보안 → 보안 그룹 → 보안 그룹 선택 → 인바운드 규칙
 ↳ ⚠️ SSH(포트 22)나 RDP(포트 3389)가 인바운드 규칙으로 /16보다 넓은 CIDR에 개방되어 있으면 취약합니다.', '1️⃣ VPC → 보안 → 보안 그룹 → 보안 그룹 생성/보안그룹 선택 → 인바운드 규칙 편집
 - RDP나 SSH의 인바운드 규칙에서 프리픽스를 /16보다 좁게 설정합니다.', '운영자, 자동화 파이프라인, 외부 도구의 원격 접속이 중단되어 운영 지연이 발생할 수 있습니다.', '', '2025-10-19 21:40:52.781382', '2025-10-19 21:40:52.781382', 2);
INSERT INTO public.guidelines VALUES (6, 'EBS 스냅샷 공개 설정시 시스템 공격 위험', 1, 1, '중요', 'EBS(Elastic Block Store) 스냅샷은 EC2 인스턴스의 디스크 백업본입니다. EBS 스냅샷을 공개로 설정하면 해당 스냅샷으로부터 EBS 볼륨을 복원하여 인스턴스 파일시스템(루트 포함)을 그대로 얻을 수 있으므로, 스냅샷에 포함된 평문 비밀 키, SSH 키, 구성 파일, 자격증명 등이 곧바로 노출될 수 있습니다.', '공격자는 자신의 계정에 스냅샷을 복사하거나 볼륨을 생성해 내부 파일을 읽어 민감정보(키, 토큰, 설정)를 추출합니다. 확보한 자격증명으로 해당 클라우드 리소스를 조작하거나, 백도어를 심고 추가 침투를 시도할 수 있으며, 이는 권한 상승과 비용 남용으로 이어질 수 있습니다.', '🧭 EC2 → Elastic Block Store → 스냅샷 → 스냅샷 선택 → 작업(Actions) → 스냅샷 설정 → 암호화
 ↳ ⚠️ EBS 스냅샷이 암호화되어있지 않거나 퍼블릭 설정일 경우 취약합니다.', '1️⃣ EC2 → Elastic Block Store 탭 → 스냅샷 → 프라이빗하려는 스냅샷 선택 → 작업 → 스냅샷 설정 → 권한수정 → 공유 옵션 
 - 소유한 EBS 스냅샷을 Private 상태로 유지해야 합니다.', '', '', '2025-10-19 21:41:38.558684', '2025-10-19 21:41:38.558684', 2);
INSERT INTO public.guidelines VALUES (7, 'S3 버킷 정책의 공개 설정과 Get/Put 권한으로 인한 데이터 탈취/악성코드 주입 위협', 1, 2, '긴급', 'Amazon S3(Simple Storage Service)는 파일(이미지, 자바스크립트, 백업 등)을 인터넷에 저장하고 꺼내 쓸 수 있게 해주는 서비스입니다. 웹사이트 정적 파일 호스팅, 로그/백업 보관 등의 용도로 자주 쓰이며, 파일 하나하나가 버킷(bucket) 이라는 폴더 모음에 들어갑니다.
버킷 정책을 모든 사용자 대상으로 공개하거나 Get/Put 권한을 허용하면 누구나 파일을 내려받거나 업로드/덮어쓰기를 할 수 있습니다.', '공격자는 공개된 버킷에서 GetObject로 백업/설정 파일을 내려받아 내부 정보와 자격증명을 확보할 수 있습니다. 또한 PutObject로 웹에서 불러오는 JS/CSS를 덮어써 방문자에게 악성 스크립트를 주입하거나, 배포 파이프라인에 악성코드를 심어 내부 침투, 데이터 유출, 장기간의 자동화 공격으로 이어질 수 있습니다.', '🧭 Amazon S3 → Buckets → 점검할 버킷 클릭 → 권한 → 퍼블릭 액세스 차단
 ↳ ⚠️ 모든 퍼블릭 액세스 차단 설정이 비활성화 되어있으면 취약합니다.

🧭 Amazon S3 → Buckets → 점검할 버킷 클릭 → 권한 → 버킷 정책
 ↳ ⚠️ 버킷 정책에서 ""Principal"": ""*"" 이거나 ""Effect"": ""Allow"" 이고, Action에 s3:GetObject 또는 s3:PutObject가 포함되어 있으면 취약합니다.', '1️⃣ Amazon S3 → 버킷 → 점검할 버킷 선택 → 권한 → 퍼블릭 액세스 차단 편집
 - 퍼블릭 용도의 버킷이 아니라면 모든 퍼블릭 액세스 차단을 활성화해야 합니다.

2️⃣ Amazon S3 → 버킷 → 점검할 버킷 선택 → 권한 → 버킷 정책 편집
 - Principal은 특정 AWS 계정/역할/사용자 ARN으로 한정하고 Resource는 버킷 안 특정 폴더로 지정해야 합니다.', '정상적인 퍼블릭 호스팅, 프리사인드 URL, 외부 파트너, Cross-Account 백업/배포 등 워크플로에 영향을 주어 서비스 장애나 배포에 실패할 수 있습니다.', '', '2025-10-19 21:42:59.884202', '2025-10-19 21:42:59.884202', 2);
INSERT INTO public.guidelines VALUES (8, 'S3 객체/버킷 ACL에 의한 외부 접근 허용 및 정보유출 위험', 1, 2, '중요', 'ACL(Access Control List)은 S3 버킷이나 객체에 누가 이 파일을 읽거나 쓸 수 있는지를 지정하는 오래된 권한 설정 방식입니다.
만약 ACL 객체/버킷 ACL에 All Users/Authenticated Users 또는 12자리 AWS 계정 ID가 Grantee로 포함되어 있으면 누구든지(또는 특정 계정이) 즉시 파일을 내려받을 수 있고, 쓰기 권한이 포함되면 파일을 덮어쓸 수 있습니다.', '공격자는 공개되었거나 S3 ACL의 과도한 권한을 통해 백업/설정 파일과 같은 민감 객체를 지속적으로 내려받아 내부에 침투할 수 있습니다. 배포 파이프라인을 통해 내부 시스템으로 악성코드를 전파하고 영구화함으로써 장기적 데이터 유출, 권한 확장, 공급망형 공격으로 이어질 수 있습니다.', '🧭 Amazon S3 → 버킷 → 점검할 버킷 선택 → 권한 → ACL(액세스 제어 목록) 편집
 ↳ ⚠️ 객체/버킷 ACL의 All Users 또는 Authenticated users가 List objects, Read objects, Write 등 권한을 가지고 있으면 취약합니다.
 ↳ ⚠️ 피부여자가 Cross-Account로 반드시 S3의 공유가 필요한 상황이 아니라면, 피부여자 목록에 12자리 숫자(외부 AWS 계정 ID)가 보이면 취약합니다.', '1️⃣ Amazon S3 → 버킷 → 점검할 버킷 선택 → 권한 → ACL(액세스 제어 목록) 편집
 - 해당 피부여자(모든 사람/인증된 사용자 그룹)를 체크 해제하거나 삭제해야 합니다.
 - 피부여자 목록에 알 수 없거나 필요 없는 12자리 숫자(외부 AWS 계정 ID)가 보이면 삭제하거나 검증해야 합니다.', '정상적인 퍼블릭 호스팅, 프리사인드 URL, 외부 파트너, Cross-Account 백업/배포 등 워크플로에 영향을 주어 서비스 장애나 배포에 실패할 수 있습니다.', '💡 이 항목은 S3에서 권한 부여 수단으로 ACL을 사용하는 환경을 전제로 합니다.', '2025-10-19 21:44:15.231606', '2025-10-19 21:44:15.231606', 2);
INSERT INTO public.guidelines VALUES (9, 'S3 버킷 복제 권한 악용에 의한 데이터 유출 위험', 1, 2, '긴급', 'S3 버킷 복제는 한 버킷의 객체를 자동으로 다른 버킷으로 복사하는 기능이며, 원래 백업과 감사를 위한 기능입니다.
복제 대상이 우리 조직에서 소유/관리하지 않는 버킷으로 잘못 설정되어 있으면 복제 통제가 불가능해질 수 있습니다.', '공격자가 복제 대상이 소유/관리하지 않는 외부 버킷으로 설정된 점을 악용해 백업/설정 파일을 대량으로 복제하고 다운로드하면 내부 구성 정보와 자격증명을 획득할 수 있습니다. 획득한 자격증명으로 권한을 확장하거나 배포 파이프라인을 조작하면 내부 시스템 접근, 지속적인 데이터 유출 및 악성코드 유포로 이어질 수 있습니다.', '🧭 S3 → 버킷 → 점검할 버킷 선택 → 관리 탭 → 복제 규칙 → 점검할 규칙 선택 → IAM 역할
 ↳ ⚠️ S3 복제 규칙의 대상 버킷 ARN이 우리 조직에서 소유/관리하는 허용 대상에 포함되어 있지 않으면 취약합니다.', '1️⃣ S3 → 버킷 → 점검할 버킷 선택 → 관리 탭 → 복제 규칙 → 점검할 규칙 선택 → IAM 역할
 - S3 복제 규칙의 대상 버킷 ARN은 우리 조직에서 소유/관리하는 허용 대상에 포함되어 있어야 합니다.', '기존의 외부 연동된 백업/감사 파이프라인이나 CI/CD 자동화에 실패해 서비스 및 배포가 중단될 수 있습니다.', '', '2025-10-19 21:45:05.390574', '2025-10-19 21:45:05.390574', 2);
INSERT INTO public.guidelines VALUES (10, 'IAM 자격증명 평문 저장으로 인한 유출', 1, 3, '중요', '소스코드에 평문으로 저장된 AWS 자격증명은 누구나 해당 파일을 내려받아 즉시 재사용할 수 있으므로, 자격증명이 노출되면 계정 및 리소스에 대한 무단 접근이 즉각적으로 가능해집니다.
특히 이러한 자격증명은 자동화 파이프라인에 하드코딩되어 있는 경우가 많아, 노출 시 회수 및 교체가 지연될 수 있습니다.', '공격자는 노출된 액세스 키로 S3 객체 열람/업로드/삭제, IAM/EC2 등 권한 범위 내의 AWS API를 호출하고 데이터 유출, 권한 오용, 리소스 파괴 등을 수행할 수 있습니다.
또한 자격증명이 버전관리 이력 등에 남아 제거가 어렵고, 공개 저장소나 잘못된 접근 설정과 결합되면 대규모 피해로 확산되어 장기적인 침해로 이어질 수 있습니다.', '🧭 오픈소스 Credential 스캐닝 도구 활용
 ↳ ⚠️ Trufflehog, Gitleaks 등과 같이 시크릿 스캐닝 도구를 통해 정규 표현식을 활용하여 평문 저장된 자격증명이 나오면 취약합니다.', '1️⃣ AWS Systems Manager → 어플리케이션 도구 탭 → 파라미터 스토어 → 파라미터 생성
 - Systems Manager Parameter Store로 자격증명을 관리해야 합니다.', '파라미터 스토어는 API 기반 서비스이므로 컨테이너 수백 개가 동시에 파라미터를 조회하는 경우 지연 또는 실패가 발생할 수 있습니다. 또한 정기 스캔, 결과 검증, 키 폐기 자동화 절차를 사람이 반복 관리해야 하여 운영상의 부담이 야기될 수 있습니다.', '', '2025-10-19 21:48:03.436012', '2025-10-19 21:48:03.436012', 2);
INSERT INTO public.guidelines VALUES (11, '장기 Access Key 보관 및 변경 주기 미흡', 1, 3, '긴급', 'AKIA로 시작하는 장기 액세스 키는 IAM 사용자 또는 AWS 계정 루트 사용자를 위한 고유한 ID입니다. 장기 액세스 키(AKIA)는 만료되지 않는 영구 자격증명이기 때문에 한 번 노출되면 지속적인 침투 수단이 됩니다.', '공격자는 최초에 탈취한 키로 리소스를 탐색하다가 새로운 사용자나 역할을 생성할 수 있는 권한이 있다면, 액세스 키가 탐지되고 만료되기 전에 새로운 키를 만들 수도 있습니다. 이렇게 되면 노출된 키를 교체해도 공격자는 내부 침투를 이어가며, 데이터 유출 또는 암호화폐를 캐거나 서비스까지 마비시킬 수 있습니다.', '🧭 IAM → 사용자 → 사용자 선택 → 보안 자격 증명 → 액세스 키
 ↳ ⚠️ Active 상태의 Access Key 중 Created date가 90일 초과하고 Never Used면 취약합니다.', '1️⃣ Secrets Manager → 보안 암호 → 새 보안 암호
 - 서비스용 자격증명은 Secrets Manager의 자동 회전 또는 IAM 역할로 대체해야 하고, Secrets 생성 시 “자동 교체(Auto rotation)” 옵션을 활성화했는지 확인해야 합니다.', '액세스 키를 삭제할 경우, 해당 키로 계정 및 리소스에 프로그래밍 방식으로 접근할 수 없으며 삭제된 키를 복구할 수 없습니다. 따라서 액세스 키를 삭제하기 전에 업무에 사용되고 있는지 점검해야 합니다.', '💡 키 회전 정책 기준을 90일로 정하고, 이보다 오래된 키는 단계적으로 Inactive하고 Delete 처리해야 합니다.', '2025-10-19 21:48:51.612027', '2025-10-19 21:48:51.612027', 2);
INSERT INTO public.guidelines VALUES (12, 'IAM 루트 계정 Access Key 관리 실패', 1, 3, '긴급', '루트 계정 Access Key는 계정 내 모든 권한을 행사할 수 있어 유출될 경우 즉시 전 범위의 리소스에 무단 접근이 가능해집니다.
많은 조직이 루트 계정에 MFA를 미적용하거나 키 변경 주기/권한 분리를 소홀히 하여, 키 유출 시 탐지/차단이 지연되거나 불가능한 상황이 발생합니다.', '공격자는 유출된 루트 계정 Access Key로 환경을 탐색하고, EC2 인스턴스 대량 생성, S3 데이터 탈취/삭제, 암호화폐 채굴 등 직접적 이득/파괴 행위를 수행할 수 있습니다.
루트 권한으로 생성한 리소스(SSH 키, 보안그룹, 인스턴스 등)는 신속히 확산되고, CloudTrail 비활성화/트레일 송수신 버킷 변경, CloudWatch 로그 삭제 등을 통해 흔적을 지우는 등 증거를 교란할 위험이 있어 포렌식/복구가 복잡해집니다.', '🧭 오른쪽 상단 계정 이름 → 보안 자격 증명 → 액세스 키(root user)
 → 작업(Action)
 ↳ ⚠️ Active 상태의 Access Key가 있으면 취약합니다.

🧭 오른쪽 상단 계정 이름 → 보안 자격 증명 → 멀티 팩터 인증(MFA)
 ↳ ⚠️ 루트 계정에 MFA(가상/하드웨어) 가 설정되어 있지 않으면 취약합니다.', '1️⃣ 오른쪽 상단 계정 이름 → 보안 자격 증명 → 액세스 키(root user)
 → 작업(Action)
 - Active 상태의 Access Key를 즉시 비활성화 후 삭제 조치해야 합니다.

2️⃣ 오른쪽 상단 계정 이름 → 보안 자격 증명 → 멀티 팩터 인증(MFA)
 - 루트 계정에 MFA가 설정되어 있어야 합니다. MFA 디바이스 할당에 들어가 원하는 인증 앱을 선택하여 MFA를 추가합니다.', '액세스 키를 삭제할 경우, 해당 키로 계정 및 리소스에 프로그래밍 방식으로 접근할 수 없으며 삭제된 키를 복구할 수 없습니다. 따라서 액세스 키를 삭제하기 전에 업무에 사용되고 있는지 점검해야 합니다.', '', '2025-10-19 21:50:12.556823', '2025-10-19 21:50:12.556823', 2);
INSERT INTO public.guidelines VALUES (13, 'IAM Role의 Trust Policy 속 광범위한 Principal', 1, 3, '긴급', 'IAM Role의 Trust Policy 신뢰 대상을 Principal: "*" 또는 광범위하게 허용하면 모든 AWS 계정의 주체가 해당 역할을 할당(AssumeRole)할 수 있으므로, 의도치 않은 외부 공격자가 즉시 권한을 획득할 수 있습니다. 조직/계정 경계가 무의미해지므로, 공격자가 다른 계정으로 권한을 넓혀 나가며 조직 내 약한 계정/설정을 통해 권한 상승이 쉬워집니다.', '공격자는 공개/유출된 다른 AWS 계정에서 sts:AssumeRole을 호출해 피해자 역할을 취득한 뒤, 그 역할에 부여된 권한 범위 내에서 데이터 열람/수정/삭제, 리소스 프로비저닝, 권한 변경 등 악의적 활동을 수행할 수 있습니다.
특히 Organizations 구조를 이용한 피벗 사례처럼, 한 계정의 취약한 신뢰 설정이 전체 조직으로 확산되어 횡적 이동하며 영속성 확보로 이어질 수 있습니다.', '🧭 IAM → 역할 → 점검할 역할 선택 → 신뢰 관계
 ↳ ⚠️ Trust Policy의 Principal: ""*""가 있고, Condition(예: aws:SourceAccount, aws:SourceArn, aws:PrincipalOrgID) 같은 제한이 없으면 취약합니다.', '1️⃣ IAM → 역할 → 역할 선택 → 신뢰 관계 → 신뢰 관계 편집 
 - Trust Policy의 Principal: ""*""를 제거하고, 사용할 계정/역할/서비스의 ARN만 명시해야 합니다.
 - 서비스 Principal에는 aws:SourceAccount, aws:SourceArn, aws:PrincipalOrgID 같은 Condition을 추가해야 합니다.', '기존에 할당된 권한을 제거할 경우, 특정 리소스에 접근이 불가능할 수 있습니다.', '', '2025-10-19 21:50:59.795224', '2025-10-19 21:50:59.795224', 2);
INSERT INTO public.guidelines VALUES (14, 'IAM PassRole으로 비인가자의 영구적 권한 획득', 1, 3, '확인요망', 'iam:PassRole 권한이 있으면 공격자가 자신이 가진 권한 범위 밖의 역할(Role)을 AWS 서비스에 붙여 그 역할의 권한을 악용할 수 있습니다. 즉, 단순히 ‘역할을 전달’할 수 있는 권한만으로도 임시 자격증명 획득후 권한 상승이 가능해집니다.
특히 PassRole이 Resource"":""*"" 또는 광범위한 역할에 허용되어 있으면 공격 위험성이 크게 커집니다.', '공격자는 RunInstances, CreateFunction, StartTask 등 서비스 호출과 조합해 역할을 가진 리소스를 생성하고 해당 역할로 액세스 토큰을 얻습니다. 얻은 토큰으로 S3/Secrets Manager/RDS 등 민감 리소스를 읽어 데이터 유출, 자격증명 탈취, 권한 확장을 수행합니다. 결국 계정 전체가 장악되어 암호화폐 채굴, 랜섬웨어 등 악성행위가 발생할 수 있습니다.', '🧭 IAM → 정책 → 정책 선택 → 정책 편집
 ↳ ⚠️ iam:Passrole로 전달 가능한 역할에 대해서 Resource"":""*"" 또는 광범위하게 지정하면 취약합니다.', '1️⃣ IAM → 정책 → 정책 선택 → 정책 편집
 - iam:Passrole action의 Resource 지정하여 전달 가능한 역할에 대해서 Resource"":""*""보다는 특정 ARN 리스트로 한정하여 대상 역할을 구체적으로 관리해야 합니다.', '기존에 할당된 권한을 제거할 경우, 특정 리소스에 접근이 불가능할 수 있습니다.', '', '2025-10-19 21:51:54.332835', '2025-10-19 21:51:54.332835', 2);
INSERT INTO public.guidelines VALUES (15, 'Identity Federation을 통한 비인가자의 역할 취득 및 리소스 접근', 1, 3, '중요', 'Identity Federation을 통해 외부 IdP(사내 AD/Okta/Google Workspace 등) 계정으로 AWS 역할을 취득하게 하면, 해당 IdP에서 인증된 사용자는 AWS 리소스에 접근할 수 있습니다.
AssumeRolePolicy에 IdP 속성값(특정 SAML attribute 값, OIDC sub/aud/iss 등)에 대한 Condition 검사가 누락되거나, Principal이 광범위하게 허용되어 있으면 IdP 세션/토큰 탈취 시 누구나 역할을 취득하여 내부 권한을 악용할 수 있습니다.', '공격자는 탈취한 IdP 세션/토큰으로 AssumeRoleWithSAML/AssumeRoleWithWebIdentity 등을 호출하여 임시 자격증명을 취득하고, 해당 역할이 허용하는 범위 내에서 리소스 열람/수정/삭제, 권한 생성 등 악의적인 행동을 수행합니다.', '🧭 IAM → 역할 → Federation 연동 역할 선택 → 신뢰 관계
 ↳ ⚠️ AssumeRolePolicy의 Principal이 모든 IdP/Principal: "*" 또는 특정 IdP의 모든 사용자로 허용되거나, IAM Role과 IdP 매핑에서 Condition으로 특정 IdP 속성값(특정 SAML attribute 값, OIDC sub/aud/iss 등)을 검사하지 않으면 취약합니다.', '1️⃣ IAM → 역할 → Federation 연동 역할 선택 → 신뢰 관계 → 신뢰 관계 편집
 - 역할의 AssumeRolePolicy에 허용되는 Principal을 명확히(특정 IdP ARN만) 하고, 가능한 경우 Condition을 추가해 허용되는 IdP 속성값(특정 SAML attribute 값, OIDC sub/aud/iss 등)으로만 할당 가능하게 제한해야 합니다.', '정상 사용자/자동화(빌드 및 배포)/협력 파트너의 접근이 차단되거나, IdP 메타데이터 변경, 운영/복구 복잡도 증가와 같은 부작용이 발생할 수 있습니다.', '', '2025-10-19 21:52:56.795466', '2025-10-19 21:52:56.795466', 2);
INSERT INTO public.guidelines VALUES (16, 'Cross-Account 접근 설정 미흡', 1, 3, '중요', 'Cross-Account 신뢰 정책을 단순히 계정 ID나 역할 ARN만으로 넓게 허용하면, 제3자(예: SaaS)가 정상적으로 행하는 역할 획득 흐름이 공격자에게도 열려 있게 됩니다. 이 경우 공격자는 정상 서비스의 기능을 악용하여 고객 계정의 권한을 대신 받아 민감 자원에 접근하거나 다른 계정으로 권한을 전파할 수 있습니다.
또한 External ID 같은 추가 검증을 하지 않으면 권한이 오남용될 위험이 큽니다.', '공격자가 SaaS 연동 흐름을 악용하면, SaaS를 통해 고객 계정의 역할을 호출하여 임시 자격증명을 획득할 수 있습니다. 획득한 자격증명으로 같은 조직 내 다른 계정의 역할을 추가로 획득하거나, 민감 데이터 추출/리소스 변경 등의 공격을 수행할 수 있습니다. 이로 인해 단일 계정 취약점이 조직 전체로 확산될 가능성이 존재합니다.', '🧭 IAM → 역할 → cross-account 용으로 쓰이는 역할 선택 → 신뢰 관계
 ↳ ⚠️ AssumeRolePolicy의 Principal: ""*"" 또는 모든 계정을 허용하는 상태이거나, Trust Policy에 sts:ExternalId 요구가 없어 고객별 고유 External ID 없이 누구나 역할을 획득할 수 있으면 취약합니다.', '1️⃣ IAM → 역할 → cross-account 용으로 쓰이는 역할 선택 → 신뢰 관계 → 신뢰 관계 편집
 - AssumeRolePolicy이 특정 provider ARN 또는 역할 ARN으로 제한되어 있고, 해당 Trust Policy에 Condition으로 sts:ExternalId를 요구해야 합니다.', '정상 SaaS 연동이나 기존 자동화 흐름이 실패해 서비스 중단 또는 CI/CD 장애가 발생할 수 있습니다.', '💡 External ID는 신뢰 관계를 맺은 당사자 간에 사전에 합의한 암구호로, 역할을 획득할 때 호출자가 이 값을 함께 제출하도록 요구하면 제3자에 의한 권한 오남용을 막는 추가 인증 수단이 됩니다.', '2025-10-19 21:53:41.547277', '2025-10-19 21:53:41.547277', 2);
INSERT INTO public.guidelines VALUES (17, '퇴직자의 IAM 권한 미철회로 인한 유출 위험', 1, 3, '긴급', '퇴직자의 IAM 권한을 즉시 철회하지 않으면 더 이상 접근할 필요가 없는 계정과 키가 그대로 남아 있게 되고, 이는 조직 리소스에 무단 접근할 수 있는 위험을 초래합니다.
계정 탈취, 권한 오남용으로 이어질 수 있으며 보안 사고 발생 시 추적 및 통제도 어려워집니다.', '전직 직원이 기존 계정을 통해 로그인하여 민감 데이터를 유출하거나, 공격자가 오래된 자격증명을 탈취해 무단으로 리소스에 접근할 수 있습니다.
이 과정에서 불필요한 권한으로 인해 서비스 삭제, 비용 폭증, 데이터 조작이 발생할 수 있으며 사고가 일어나도 책임 추적이 어려워 보안 거버넌스가 붕괴될 수 있습니다.', '🧭 IAM → 사용자 → 사용자 목록에서 대상(퇴직자) 사용자 클릭 → 보안 자격 증명
 ↳ ⚠️ 퇴직한 사용자가 IAM 사용자 계정(콘솔 로그인 프로필) 을 그대로 보유하고 있고, 해당 사용자에게 Active 상태의 Access Key 또는 프로그램 액세스 권한이 남아 있으면 취약합니다.

🧭 CloudTrail → 이벤트 기록 → 사용자 이름 필터로 해당 사용자의 최근 활동 확인
 ↳ ⚠️ CloudTrail에서 퇴직 후에도 해당 계정의 API 호출/콘솔 로그인 기록이 발견되면 취약합니다.', '1️⃣ IAM → 사용자 → 사용자 목록에서 대상(퇴직자) 사용자 클릭 → 보안 자격 증명
 - 로그인 프로필을 삭제해 콘솔 접근을 차단합니다.
 - 모든 Access Key를 비활성화 후 삭제합니다.
 - MFA, 인증서, 서비스 자격증명을 모두 해제합니다.

2️⃣ IAM → 사용자 → 사용자 목록에서 대상(퇴직자) 사용자 클릭 → 권한
 - 권한 탭에서 그룹과 연결된 정책을 제거 후 최종 사용자 삭제해야 합니다.', '사전 확인 없이 퇴직자 계정을 비활성화하면 그 계정의 자격증명에 의존하던 자동화, CI/CD, 서비스가 중단되어 배포 및 작업 실패와 서비스 가용성이 저하될 수 있습니다.', '', '2025-10-19 22:21:29.565913', '2025-10-19 22:21:29.565913', 2);
INSERT INTO public.guidelines VALUES (18, 'MFA 미설정', 1, 3, '중요', 'MFA가 설정되어 있지 않은 계정은 비밀번호 유출/재사용/브루트포스 공격으로 즉시 탈취될 수 있으므로, 콘솔 로그인 보호의 최종 방어선이 부재한 상태입니다.
또한 일부 인증 환경에서 요청 제한이 충분히 적용되지 않아 브루트포스 공격이 가능하며, MFA가 설정되지 않은 계정은 쉽게 침해될 수 있습니다.', '공격자는 계정 탈취 시 콘솔을 통해 해당 계정이 가지고 있는 권한 범위 내에서 내부 침투합니다. 추가 자격증명 생성, 권한 확장, 코인마이너 등을 수행할 수 있으며, 이는 서비스 중단, 데이터 손실 등으로 이어질 수 있습니다.', '🧭 IAM → 사용자 → 각 사용자 선택 → 보안 자격 증명 → 멀티 팩터 인증(MFA)
 ↳ ⚠️ 루트를 포함한 모든 사용자 계정에 MFA가 설정되어 있지 않으면 취약합니다.', '1️⃣ IAM → 사용자 → 각 사용자 선택 → 보안 자격 증명 → 멀티 팩터 인증(MFA)
 - 루트를 포함한 모든 사용자 계정에 MFA가 설정돼야 합니다.', '', '', '2025-10-19 22:22:12.490331', '2025-10-19 22:22:12.490331', 2);
INSERT INTO public.guidelines VALUES (19, 'Security Group의 광범위한 공개 규칙 설정으로 인한 서비스 노출 및 권한 탈취 위험', 1, 4, '중요', 'Security Group은 인스턴스에 붙이는 상태 기반(stateful) 방화벽입니다. 특정 포트(예: SSH 22, RDP 3389, DB 포트 등)를 불필요하게 /16보다 넓은 광범위한 CIDR로 허용하면 누구나 해당 서비스에 접근 시도(브루트포스/익스플로잇)를 할 수 있습니다.', '자동화된 스캐너나 공격자가 공개된 포트로 취약점을 찾아 원격 코드 실행을 성공시키면 인스턴스가 장악됩니다. 공격자는 장악된 인스턴스에서 로컬 자격증명/비밀/권한을 악용해 민감 데이터 추출, 추가 권한 획득, 내부 네트워크 횡적 이동 등을 수행하여 침해 범위를 확장할 수 있습니다.', '🧭 EC2 → 인스턴스 → 인스턴스 선택 → 보안탭 → 보안그룹 → 인바운드 규칙
 ↳ ⚠️ Inbound 규칙이 데이터베이스/관리 서비스 포트로 불필요하게 열려 있거나, Source가 너무 넓은 퍼블릭 CIDR(~/16)이면 취약합니다.', '1️⃣ EC2 → 인스턴스 → 인스턴스 선택 → 보안탭 → 보안그룹 → 인바운드 규칙 → 편집
 - 보안그룹은 기존의 그룹에서 규칙변경 시 바로 적용되지 않기 때문에 해당 인스턴스 CIDR의 프리픽스 길이를 불필요하게 열지 않도록 새로운 보안 그룹을 생성한 뒤 교체해야 합니다.', '모니터링/배포/백업/서드파티 연동/운영자 원격 접속 등이 차단되어 서비스 접근 실패나 배포 중단, 긴급 복구 지연과 같은 운영 장애가 발생할 수 있습니다.', '💡 Security Group 규칙 변경은 즉시 적용되어 신규 연결은 즉시 차단되지만, 기존에 이미 열린 연결은 계속 유지될 수 있어 적용 전 확인해야 합니다.', '2025-10-20 14:26:56.223698', '2025-10-20 14:29:21.189914', 2);
INSERT INTO public.guidelines VALUES (20, '배스천 호스트 미사용으로 인한 프라이빗 서브넷 자원 직접 접근 위험', 1, 4, '중요', '배스천 호스트는 인터넷에서 프라이빗 서브넷으로 접근할 때 안전한 관문 역할을 하는 전용 접속 서버입니다. 배스천 호스트를 사용하지 않으면 인스턴스를 퍼블릭 서브넷에 배치해 공인 IP를 할당해야 하므로 외부에서 직접 접근 가능해져 공격에 취약합니다.', '배스천 호스트를 사용하지 않고 일부 인스턴스가 퍼블릭 서브넷에 공인 IP로 존재하면 포트 스캐닝/자동화 공격으로 SSH/RDP를 이용한 브루트포스 공격이 가능해집니다. 공격자가 한 인스턴스를 장악하면 내부 네트워크로 측면 이동해 더 민감한 리소스(데이터베이스, 파일서버 등)에 접근할 수 있습니다.', '🧭 EC2 → 인스턴스 → 해당 인스턴스 선택 → 네트워킹 → 서브넷 ID → 라우팅 테이블
 ↳ ⚠️ 외부 접근을 차단/제한/검증해야 하는 중요 인스턴스가 퍼블릭 서브넷에 공인 IP를 보유하고 있으면 취약합니다.', '1️⃣ EC2 → 보안그룹 → 보안그룹 생성
 - 인바운드 규칙 / 아웃바운드 규칙 - 접속 IP 제한 후 VPN 솔루션을 통한 내부망 접속 규칙을 적용한다. (개발 환경에 따라 0.0.0.0 등으로 설정 후 접속 IP 제한 설정 적용한다.)

2️⃣ EC2 → 인스턴스 → 인스턴스 시작
 - 배스천 호스트용 EC2의 보안그룹을 접속할 IP 제한(개발 환경은 0.0.0.0 등)으로 설정하여 연결가능한 EC2를 생성한다.', '배스천 호스트를 거쳐서 내부 서버에 접속하므로 접속 경로가 한 단계 늘어나며 약간의 지연이 발생할 수 있습니다. 또한 계속해서 패치, 하드닝, 사용자 계정 관리 등이 필요하며 운영자가 많아질수록 계정/키/정책 관리는 복잡해집니다.', '', '2025-10-20 14:30:20.999847', '2025-10-20 21:18:09.237844', 2);
INSERT INTO public.guidelines VALUES (21, 'Lambda 코드/환경변수에 중요정보 노출', 1, 5, '중요', 'Lambda 환경에는 함수가 실행될 때 사용되는 임시 IAM 자격증명과 함수를 호출한 요청 데이터가 존재합니다. 이 정보들이 함수의 환경변수나 런타임에서 평문으로 남아 있거나, 함수가 외부 입력을 통해 내부 파일이나 내부 서비스에 접근하도록 허용하면, 공격자는 그 정보를 탈취해 S3/EC2/IAM 등 다른 AWS 리소스에 접근할 수 있습니다.', '공격자는 웹 애플리케이션의 파일 읽기 취약점이나 함수 로직의 입력 반영 취약점을 이용해 Lambda의 환경변수나 실행 정보(환경설정 등)를 노출시킬 수 있으며, 탈취한 임시 자격증명으로 S3/DB/IAM 등으로 접근해 데이터 유출/권한 확대를 수행합니다.', '🧭 Lambda → 함수 → [대상 함수 명] → 구성 탭 → 환경 변수
 ↳ ⚠️ 환경변수 목록에서 AWS_SECRET_KEY, ACCESS_KEY, SECRET, TOKEN, API key 등 중요정보가 평문으로 있으면 취약합니다.', '1️⃣ Lambda → 함수 → [대상 함수 명] → 구성 탭 → 환경 변수
 - KMS의 Customer managed keys에서 Key를 생성한 뒤 Lambda 환경 변수 편집에서 ‘고객 마스터 키 사용’에 생성한 CMK를 선택 후 저장하도록 합니다.', 'Lambda 환경변수의 자격증명이나 API Key를 SSM Parameter Store(KMS 암호화)로 옮기면, Lambda 실행 역할에 ssm:GetParameter 및 kms:Decrypt 권한이 없을 경우 런타임에서 자격증명을 가져오지 못해 함수가 실패하거나 기능이 중단될 수 있으므로, 필요한 SSM/Secrets/KMS 권한을 사전에 부여하고 호출량/회전/로그 노출을 고려한 설계를 병행해야 합니다.', '', '2025-10-20 14:32:48.588977', '2025-10-20 14:32:48.588977', 2);
INSERT INTO public.guidelines VALUES (22, 'Lambda 함수 내부 입력값 미검증으로 인한 인젝션 위험 노출', 1, 5, '중요', 'ambda 함수는 권한을 가진 실행 역할으로 AWS API를 호출할 수 있으므로, 함수 내부의 입력값 검증 실패로 인젝션이 발생하면 단순 입력을 통해 함수 권한 범위 내에서 민감 리소스에 접근하고 조작할 수 있습니다. 즉, 취약한 결함이 곧 클라우드 권한 남용으로 연결됩니다.', '공격자는 공개 엔드포인트나 낮은 권한 계정으로 Lambda 함수를 호출하고, 입력값에 악성 페이로드를 주입해 함수 내부에서 명령/쿼리/HTTP 요청이 실행되게 만듭니다. 실행된 인젝션은 환경변수/Secrets/메타데이터 등 민감정보를 노출하거나 임시 자격증명을 획득하게 합니다.
획득한 자격증명으로 S3/Secrets Manager/IAM 변경 등 추가 권한 남용이 발생해 데이터 유출, 영구 백도어 생성, 로그 삭제 등 심각한 피해로 이어질 수 있습니다.', '🧭 Amazon Inspector → Findings → 필터 적용(Resource type, Finding type, Severity) → 결과의 Affected resources
 ↳ ⚠️ Lambda 함수에 대해 Amazon Inspector(코드/패키지 스캔)를 실행했을 때 해당 함수의 CODE_VULNERABILITY 또는 PACKAGE_VULNERABILITY 타입의 심각도(CRITICAL 또는 HIGH) 결과가 존재하면 취약합니다.', '1️⃣ Lambda → 함수 선택 → 구성(Configuration) → 동시성 및 재귀 탐지 → 동시성 편집
 - 동시성 예약을 0으로 입력하고 저장', '함수를 사실상 끄는 것이기 때문에 호출 실패/백로그/재시도/알람 연속 발생/서비스 장애가 발생할 수 있습니다.', '', '2025-10-20 16:20:01.867246', '2025-10-20 16:20:01.867246', 2);
INSERT INTO public.guidelines VALUES (23, 'RDS 스냅샷 공개 오설정으로 인한 데이터 유출', 1, 6, '중요', 'Amazon RDS의 스냅샷은 데이터베이스 전체 상태를 통째로 저장한 백업입니다. 이 스냅샷은 원래 특정 AWS 계정과만 공유할 수 있도록 설계되어 있습니다. 하지만 관리자가 실수로 스냅샷을 Public으로 공유하면 모든 AWS 계정이 그 스냅샷을 복사하거나 복원해 내부 데이터를 볼 수 있게 됩니다.', '공격자는 공개된 RDS 스냅샷을 발견하는 즉시 이를 자신의 AWS 계정으로 복사하여 데이터베이스 전체를 복원합니다. 복원된 데이터베이스에 접근하여 공격자는 고객의 이름, 연락처, 결제 정보, 내부 시스템 접근에 필요한 정보 등 모든 민감한 데이터를 훔칠 수 있습니다. 이러한 데이터 유출은 단순한 피해를 넘어 법적 책임과 기업 신뢰도 하락으로 이어지는 심각한 보안 사고를 유발할 수 있습니다.', '🧭 Aurora and RDS → 스냅샷 → Public
 ↳ ⚠️ 스냅샷 상세에서 Visibility/Permissions 또는 Share snapshot 액션을 눌렀을 때 Public 또는 all으로 공유된 상태이면 취약합니다.', '1️⃣ Aurora and RDS → 스냅샷 → 스냅샷 선택 → 스냅샷 공유 → 스냅샷 권한 
 - DB 스냅샷 가시성을 Private으로 해야합니다.', '기존에 내부/외부에서 자동으로 복원/배포/검증하던 파이프라인이나 테스트 환경이 실패할 수 있으므로, 변경 전 영향평가와 관련 공지 및 전달 절차를 준비해야 합니다.', '', '2025-10-20 16:21:47.636022', '2025-10-20 16:21:47.636022', 2);
INSERT INTO public.guidelines VALUES (24, '공개 RDS 인스턴스로 인한 데이터 유출', 1, 6, '중요', 'RDS 인스턴스가 Publicly Accessible(인터넷 노출) 상태이면 누구나 데이터베이스 엔드포인트를 찾아 연결을 시도할 수 있습니다. 퍼블릭 서브넷 연결과 잘못된 보안그룹 규칙이 함께 있으면 DB가 외부 스캐닝/브루트포스/크리덴셜 스터핑의 표적이 됩니다.', '공격자는 인터넷을 스캔해 공개된 RDS 엔드포인트를 찾아냅니다. 공개된 DB에 대해 자동화 도구로 로그인 시도(브루트포스/크리덴셜 스터핑)를 하거나, 알려진 취약점/잘못된 계정 권한으로 접근해 데이터베이스에 침투할 수 있습니다.
침투 후에는 테이블 전체를 덤프하여 PII(개인 식별 정보)/민감정보를 빼내거나, 권한 상승/백도어 설치/서비스 파괴로 확장될 수 있습니다.', '🧭 Aurora and RDS → Databases → 점검할 DB 선택 → Connectivity & security
 ↳ ⚠️ Public accessibility 항목이 Yes로 표시되어 있으면 취약합니다.

🧭 Aurora and RDS → 서브넷 그룹 → 각각의 서브넷 라우팅 테이블 
 ↳ ⚠️ DB 서브넷 그룹을 구성하는 서브넷이 퍼블릭이면 취약합니다.

🧭 VPC → 보안 그룹
 ↳ ⚠️ 보안그룹 인바운드 규칙에 불필요하게 넓은 CIDR 범위로 DB 포트가 열려 있으면 취약합니다.', '1️⃣ Aurora and RDS → Databases → 점검할 DB 선택 → Connectivity & security
 - 퍼블릭 액세스 항목을 ‘아니오’로 변경해야 합니다.

2️⃣ Aurora and RDS → 서브넷 그룹 → 각각의 서브넷 라우팅 테이블
 - DB 서브넷 그룹을 구성하는 각각의 서브넷 라우팅 테이블 속 경로를 확인하여 Private 서브넷인지 확인합니다.

3️⃣ VPC → 보안 그룹 → 인바운드 규칙 편집
 - 보안그룹 인바운드 규칙에 불필요하게 넓은 CIDR를 제거한 뒤, 필요한 범위만 설정했는지 확인합니다.', '접근하려면 배스천 호스트, SSM Session Manager, 또는 VPN을 거쳐야 하기 때문에 운영 편의성이 저하될 수 있습니다.', '', '2025-10-20 16:22:41.792215', '2025-10-20 17:49:36.040995', 2);
INSERT INTO public.guidelines VALUES (25, 'CloudTrail 비활성화 시 로그 미수집으로 인한 추적 불가 위험성', 1, 7, '확인요망', 'CloudTrail은 AWS 계정에서 발생하는 모든 활동(누가, 언제, 무엇을 했는지)을 기록하는 ''보안 블랙박스''와 같습니다. 이 기록은 해킹 사고가 발생했을 때 공격 경로를 파악하고 피해를 복구하는 데 결정적인 증거가 됩니다.
만약 공격자가 AWS 자격증명을 탈취한 뒤, 가장 먼저 CloudTrail 로깅(기록) 기능을 비활성화하거나 기록되지 않는 방식으로 작업을 시도하면, 공격 흔적이 사라지게 되고, 추적할 수 없게 됩니다.', '공격자는 탈취한 자격증명을 이용해 CloudTrail 서비스를 비활성화하거나, AWS에서 공식적으로 기록되지 않는 것으로 알려진 비표준 엔드포인트나 API 프로토콜을 사용하여 자신의 악성 활동을 숨기려 합니다.
활동 기록이 남지 않기 때문에 공격자는 계정 내에서 마음대로 새로운 사용자나 권한을 만들고 데이터를 탈취해도 아무도 그 흔적을 추적할 수 없습니다.', '🧭 CloudTrail → 추적 → 원하는 추적 선택 → Status
 ↳ ⚠️ 추적 로깅이 꺼져있으면 취약합니다.', '1️⃣ CloudTrail → 추적 → 원하는 추적 선택 → ‘일반 세부 정보’ 편집
 - 로깅 시작을 눌러 (Organization 계층 포함)으로 추적 로깅을 활성화해야 합니다.', '', '', '2025-10-20 16:23:38.873332', '2025-10-20 16:23:38.873332', 2);
INSERT INTO public.guidelines VALUES (26, 'CloudTrail 비정상적인 API 호출 감시 미흡', 1, 7, '중요', 'CloudTrail은 계정에서 발생한 모든 API 호출을 기록해 사고 탐지/조사/대응의 근거를 제공합니다.
만약 CloudTrail이 다중 리전(Multi-Region)으로 설정되어 있지 않거나 이벤트 선택이 모든 API 활동으로 되어 있지 않으면 공격자가 다른 리전이나 관리형 API를 이용해 활동을 숨기거나 탐지를 회피할 수 있습니다.', '공격자는 유출된 API 키/자격증명을 사용해 AWS API를 연쇄 호출해 권한을 확장하거나 로그를 중지시키고 활동 증거를 지웁니다. 또는 다른 리전에서 활동을 수행(리전 간 lateral actions)한 뒤, 단일-리전만 기록하는 설정 때문에 탐지가 지연되어 데이터 유출/금전적 피해가 커집니다.
특히 자동화된 악성 배포는 수많은 API 호출로 진행되며, 일부 호출을 놓치면 침해 전후 맥락을 재구성하기 어렵습니다.', '🧭 CloudTrail → 추적 → 추적 선택 → 관리 이벤트 편집
 ↳ ⚠️ API 활동 항목이 ""쓰기 전용"" 로 설정되어 있으면 취약합니다.', '1️⃣ CloudTrail → 추적 → 추적 선택 → 관리 이벤트 편집
 - 추적의 API 활동 항목이 “읽기”, “쓰기” 모두 체크되어있어야 합니다.

2️⃣ Example : CloudTrail → 레이크 → 쿼리 → 편집기
 - 비정상적인 EC2 인스턴스 대량 생성 탐지. 특정 기간 동안 비정상적으로 많은 EC2 인스턴스(RunInstances)를 생성한 사용자, IP 주소, 리전을 찾아냅니다.

3️⃣ Example : CloudTrail → 레이크 → 쿼리 → 편집기
 - 콘솔 로그인 브루트포스 공격 시도 탐지. 특정 IP 주소에서 짧은 시간 동안 여러 번의 로그인 실패가 발생하는 경우를 찾아냅니다.', '멀티리전/모든 이벤트 수집으로 로그량이 급증해 CloudTrail 로그 전송, 처리 지연, 쿼리 성능 저하가 발생할 수 있습니다.', '', '2025-10-20 16:24:33.000971', '2025-10-20 16:24:33.000971', 2);
INSERT INTO public.guidelines VALUES (27, 'EKS 과도한 권한 설정으로 인한 Pod 침투와 자격증명 탈취', 1, 8, '중요', 'EKS에서 과도한 IAM 권한이 부여되면, 한 Pod에서 다른 Pod나 서버의 영역까지 접근할 수 있게 됩니다. 이러한 설정 실수는 공격자가 한 부분만 뚫어도 전체 클러스터를 장악하거나, Pod 내부에서 AWS 자격증명(임시 인증 키)을 훔쳐내 S3/EC2 같은 다른 서비스까지 침투하게 만듭니다.', '공격자는 잘못 설정된 Pod에 침투해 IMDS에서 자격증명을 훔칩니다. 이러한 공격은 초기 침입 성공 시 다른 Pod로 수평 이동하며, EKS 전체 클러스터가 장악될 수 있습니다.
또한 훔친 자격증명으로 S3 버킷에 접근하거나, EC2 인스턴스 종료/생성, IAM 권한 변경 등 계정 내 여러 리소스를 조작할 수 있습니다.', '🧭 IAM → 역할 → [IRSA용 Role 선택] → 권한 정책 / 쿠버네티스 ServiceAccount YAML 파일 수정
 ↳ ⚠️ EKS 환경에서 해당 SA가 관리자급 IAM Role과 연결되어 있고, IAM Role의 권한 정책이 광범위(Action"":""*"", Resource"":""*"")할 경우 취약합니다.', '1️⃣ IAM → 역할 → [IRSA용 Role 선택] → Inline Policy / 쿠버네티스 ServiceAccount YAML 파일 수정
 - EKS 환경에서 모든 Pod는 전용 서비스 계정을 사용하도록 설정하고, 기본(default) 서비스 계정을 전역 권한으로 사용하지 않아야 합니다.
 - 각 계정은 IRSA(IAM Role for Service Account)를 통해 필요한 최소 권한만 부여된 IAM Role과 개별적으로 연동되어야 합니다.', '기존 Pod나 CI/CD 파이프라인이 필요한 권한을 잃어 기능 장애나 배포에 실패할 수 있습니다.', '', '2025-10-20 16:26:10.896166', '2025-10-20 16:26:10.896166', 2);
INSERT INTO public.guidelines VALUES (28, 'KMS 권한/키 관리 오설정으로 인한 랜섬웨어 위협', 1, 9, '중요', 'KMS는 데이터 복호화의 핵심 제어점이라 공격자가 KMS 관련 권한을 얻으면 키를 교체/삭제/재지정해 복호화를 불가능하게 만들 수 있습니다. 즉, 암호화된 데이터를 클라우드 환경 안에서 ‘잠금’ 또는 ‘노출’ 상태로 만들 수 있어 전통적인 랜섬웨어보다 탐지 및 복구가 더 어렵습니다.', '공격자는 KMS 관련 권한을 탈취해 악의적인 키를 Import Key Material로 업로드하거나, 기존 키로 데이터들을 재암호화한 뒤 핵심 정보를 Delete Imported Key Material 등으로 제거해 복호화를 불가능하게 만듭니다.
이후 S3/EBS/RDS 백업 및 스냅샷을 재암호화하거나 로그(CloudTrail) 기록을 중단/변조해 탐지를 회피하고, 복구 불가능한 데이터 잠금, 서비스 중단, 금전적, 규제적 피해를 초래할 수 있습니다.', '🧭 Key Management Service (KMS) → 고객 관리형 키 → 점검할 키  → Key details, Key material, Key Policy
 ↳ ⚠️ CMK의 키 구성 원본이 외부로 설정되어 있고 kms:ImportKeyMaterial/kms:DeleteImportedKeyMaterial 권한이 광범위하게 허용되어 있거나, kms:ImportKeyMaterial에 만료가 없고 reimport/삭제 권한이 제대로 통제되지 않으면 취약합니다.', '1️⃣ Key Management Service (KMS) → 고객 관리형 키 → 점검할 키  → Key details, Key material, Key Policy
 - 고객 관리형 키의 키 소재 출처가 외부일 인 경우, kms:ImportKeyMaterial/kms:DeleteImportedKeyMaterial 등의 KMS 권한은 관리 역할을 가진 CMK ARN으로만 제한되며, Import 시 만료가 설정되어 있고, reimport/삭제는 MFA 및 승인 절차 등으로 엄격히 통제되어야 합니다.', '키 임포트/삭제에 MFA 및 승인 워크플로를 요구하면 복잡한 수동 절차가 잦아져 긴급 복구나 자동화 흐름이 지연될 수 있습니다.', '', '2025-10-20 16:27:04.095028', '2025-10-20 16:27:04.095028', 2);
INSERT INTO public.guidelines VALUES (29, 'SNS 주제 액세스 정책 과다 허용으로 인한 SMS 스미싱 악용', 1, 10, '중요', 'SNS는 특정 주제에 대해서 구독자가 있고, 그 주제에 새로운 정보를 Publish하면 그 구독자가 그 정보를 받아갈 수 있습니다.
SNS 주제에 대한 접근 정책을 설정할 때, 실수로 Principal을 전체(*)로 설정하면 인터넷상의 누구나 해당 주제에 메시지를 마음대로 Publish하거나 주제를 Subscribe하여 모든 메시지를 받아볼 수 있게 됩니다.', '공격자는 인증 없이 공개된 SNS 주제를 Subscribe하여, 해당 주제로 전달되는 모든 민감한 메시지를 실시간으로 엿볼 수 있게 됩니다. 이 메시지에는 시스템 내부 정보나 사용자 데이터가 포함되어 있을 수 있습니다.
또한 공격자는 이 주제에 악의적인 메시지를 대량으로 발행하여, 이를 수신하는 서비스 시스템을 오작동시키거나 서비스 이용자들에게 잘못된 알림을 보내는 등 피해를 유발할 수 있습니다.', '🧭 SNS → 주제 → 주제 선택 → 주제 편집
 ↳ ⚠️ sns:Publish/sns:Subscribe가 Principal: ""*"" 또는 Resource:""*""로 허용되어 스미싱 발송이 가능하거나, 임의 주체가 임의 주제에 Subscribe을 추가할 수 있도록 설정되어 있으면 취약합니다.', '1️⃣ SNS → 주제 → 주제명  → 액세스 정책 편집
 - SNS 주제 액세스 정책에서 sns:Publish, sns:Subscribe 등의 SNS 관련 권한을 Principal은 특정 계정/역할/사용자 ARN으로 고정하고, Resource는 해당 주제의 ARN으로 고정해야 합니다.', '정상적인 서비스 연동과 자동화 파이프라인의 일부가 끊어질 수 있습니다.', '', '2025-10-20 16:28:55.806056', '2025-10-20 16:28:55.806056', 2);
INSERT INTO public.guidelines VALUES (30, 'SQS 큐 정책 과도 권한', 1, 11, '중요', '서버들 사이에 처리해야 할 중요한 작업 목록(메시지)을 안전하게 전달하는 SQS 큐에 Queue Policy(큐 정책)를 설정할 때, 실수로 Principal을 전체(*)로 설정하거나 조건을 너무 넓게 허용하는 경우가 있습니다.
이렇게 되면 누구나 큐에 메시지를 마음대로 보내거나 큐에 담긴 민감한 메시지를 읽고 삭제할 수 있게 됩니다.', '공격자는 공개된 큐 정책을 악용하여 큐에 담긴 민감한 메시지를 훔쳐내 내부 시스템의 정보나 자격증명을 파악합니다.
또한 공격자는 위조된 메시지를 큐에 넣어 뒤에서 작업하는 백엔드 서버에 잘못된 명령을 실행하게 만들 수 있습니다.
이로 인해 서비스 장애나 데이터베이스 권한 탈취로 이어질 수 있으며, 최종적으로는 시스템 변경이나 민감 정보 유출 같은 심각한 피해를 초래할 수 있습니다.', '🧭 Amazon SQS → 대기열 → 대기열 선택 → 액세스 정책 편집
 ↳ ⚠️ 액세스 정책에 Principal: ""*"" 또는 사용하지 않는 사용자/계정이 명시되어 있으면 취약합니다.', '1️⃣ Amazon SQS → 대기열 → 대기열 선택 → 액세스 정책 편집
 - 액세스 정책에서 Principal을 특정 계정/역할/서비스 ARN으로만 제한해야 합니다.', '내부 AWS 서비스/다른 계정/자동화 시스템 등이 SQS 접근 권한을 잃어 이벤트 전달 체인 자체가 끊길 수 있으므로, 필요한 ARN만 정책에 남기고 알림 동작을 검증한 후 이상이 없을 때에만 Principal: "*"을 최종 제거합니다.', '', '2025-10-20 16:29:46.801933', '2025-10-20 16:29:46.801933', 2);
INSERT INTO public.guidelines VALUES (31, 'Route 53 DNS 레코드 미정리로 인한 Takeover', 1, 12, '중요', '사용자가 S3 버킷, EC2 인스턴스 같은 AWS 클라우드 자원을 삭제할 때, 해당 자원을 가리키던 DNS 레코드(CNAME)나 CloudFront 배포 설정을 함께 삭제하는 것을 잊어버리면 DNS 레코드는 ''댕글링(Dangling)'' 상태, 즉, 존재하지 않는 주소를 계속 가리키는 상태로 남아있게 됩니다.', '공격자는 탈취한 도메인(서브도메인)을 이용해 피싱 페이지, 악성 스크립트, 또는 멀웨어를 호스팅하고, 원래 도메인의 신뢰도를 유지한 채 사용자에게 전달합니다.
사용자는 평소 방문하던 정상적인 주소라고 믿고 접속하기 때문에 의심하지 않고 악성 스크립트를 실행하게 됩니다. 이 스크립트를 통해 공격자는 사용자의 쿠키나 세션 정보를 훔쳐 세션 하이재킹을 시도하거나, 공급망 공격의 일부로 악성 코드를 배포하는 등 다양한 방식으로 피해를 확대할 수 있습니다.', '🧭 Route 53 → 호스팅 영역 → 점검할 호스트존 → Records
 ↳ ⚠️ CNAME/ALIAS가 특정 서비스를 가리키는데 해당 리소스가 존재하지 않거나 소유자가 확인되지 않으면 취약합니다.', '1️⃣ Route 53 → 호스팅 영역 → 점검할 호스트존 → Records
 - 해당 리소스가 실제 소유/운영 중인지 확인하고, 아니면 즉시 레코드 삭제 또는 올바른 내부 리소스로 변경해야 합니다.', '정리 작업을 검증없이 수행하면 실제로는 여전히 사용중인 서비스나 서브도메인의 연결이 끊겨 서비스 중단/페이지 오류가 발생할 수 있습니다.', '', '2025-10-20 16:30:42.229972', '2025-10-20 16:30:42.229972', 2);
INSERT INTO public.guidelines VALUES (32, 'Organizations Trusted Access 관리 미흡으로 조직 전체 계정 장악', 1, 13, '긴급', '신뢰할 수 있는 액세스(Trusted Access)를 활성화하면 특정 AWS 서비스가 조직 전체에 대해 자동으로 서비스 전용 권한을 획득해 멤버 계정에서 리소스를 생성하고 변경할 수 있습니다.
최상위 계정(Management Account)이 탈취되거나 관리자가 고의 또는 실수로 신뢰할 수 있는 액세스를 활성화하면, 중앙에서 조직 내 모든 하위 계정(Member Account)에 관리자 권한을 가진 역할을 자동으로 생성하고 침투할 수 있습니다.', '공격자는 최상위 계정을 장악한 다음, 신뢰할 수 있는 액세스를 이용해 조직 내 모든 계정에 악의적인 템플릿을 배포합니다. 이를 통해 모든 계정에 자신만의 관리자 계정을 만들거나, 전체 계정의 데이터를 유출시키거나, 조직 전체 인프라에 랜섬웨어를 배포하는 등 한 번에 모든 것을 장악합니다.', '🧭 AWS Organizations → 서비스 → 조직에 대해 활성화된 서비스 목록
 ↳ ⚠️ 조직 전체에 활성화된 신뢰할 수 있는 액세스 서비스를 정기적으로 확인하지 않거나, 업무상 필요한 서비스만 유지하고 불필요한 서비스를 즉시 비활성화하지 않으면 취약합니다.', '1️⃣ AWS Organizations → 서비스 → 조직에 대해 활성화된 서비스 목록 
 - 조직 전체에 활성화된 신뢰할 수 있는 액세스 서비스를 정기적으로 확인하고, 업무상 필요한 서비스만 남기며 불필요한 서비스는 즉시 비활성화해야 합니다.', 'Trusted Access 비활성화로 인해 조직 통합 기능(조직 단위 스캔/배포/집계)이 일부 중단될 수 있으며, 배포/운영 자동화 실패로 수동 작업이 증가할 수 있습니다.', '', '2025-10-20 16:31:35.511076', '2025-10-20 16:31:35.511076', 2);
INSERT INTO public.guidelines VALUES (33, 'Organizations SCP 미적용으로 인한 불필요 API 호출', 1, 13, '중요', '서비스 제어 정책(Service Control Policy)를 적용하지 않으면 조직 차원의 최상위 가드레일이 사라져 멤버 계정에서 실행 가능한 API 범위를 중앙에서 제한할 수 없습니다.
그 결과 멤버 계정에서 본래 업무상 불필요하거나 영구적 변경을 야기하는 API 호출이 가능해져 데이터 유출, 모니터링 무력화, 권한 오남용 등 조직 전체 리스크로 빠르게 확산될 수 있습니다.', '공격자는 멤버 계정 자격증명을 획득해 SCP를 적용하지 않거나 느슨한 조직에서 불필요하거나 영구적 변경을 야기하는 API를 호출해 인프라를 장악할 수 있습니다.
이러한 API 호출은 복구를 불가능하게 만들고, 멤버 계정에서 발생한 변화가 중앙 통제 없이 확산되어 사고 대응을 복잡하게 만듭니다.', '🧭 AWS Organizations → 정책 → 서비스 제어 정책 → 새 서비스 제어 정책 생성
 ↳ ⚠️ 조작 실수 혹은 비인가자의 침해 행위로 인해 특정 API가 의도치 않게 호출된다면 취약합니다.', '1️⃣ AWS Organizations → 정책 → 서비스 제어 정책 → 새 서비스 제어 정책 생성
 - 불필요하거나 영구적 변경을 야기하는 API들을 선별해 기본 Deny하는 보호용 SCP 정책을 작성해야 합니다.', 'SCP를 과도하거나 무분별하게 적용하면 정상 운영이 중단될 수 있으므로, SCP 적용은 차단과 허용되는 관리 기능 간 영향 평가를 반드시 선행해야 합니다.', '', '2025-10-20 16:32:15.984193', '2025-10-20 16:32:15.984193', 2);
INSERT INTO public.guidelines VALUES (34, '잘못된 ECR 관련 정책으로 인한 악성코드 위협', 1, 14, '중요', 'ECR 리포지토리는 리소스 기반 정책을 지원합니다. 여기서 Principal을 전체(*)로 설정하면 누구나 Push/Pull 할 수 있는 리포지토리가 됩니다. 쓰기(Push) 권한이 외부에 열려 있으면 악성 이미지 업로드, 기존 태그 덮어쓰기(태그 하이재킹), 이미지 삭제가 가능해집니다.
특히 CI/CD나 개발 계정에 이런 권한이 풀려 있으면 공격자가 손쉽게 악성 이미지를 주입할 수 있습니다.', '공격자는 악성 이미지를 레지스트리에 업로드한 뒤 정상 워크로드가 이를 내려받아 실행하게 만듭니다.
이렇게 되면 백도어를 설치하고 지속적으로 유지할 수 있으며, 이를 통해 내부 네트워크로 수평 이동하거나 비밀값을 탈취할 수 있습니다.', '🧭 Amazon Elastic Container Service → 프라이빗 리포지토리 → 권한
 ↳ ⚠️ 리포지토리 정책에 Principal: ""*"" 또는 외부/불특정 주체에 Push/Pull을 무제한 허용하거나 Push와 Pull 권한이 불필요하게 부여되어 있고, Image scanning이 비활성화되어 있으며 태그 불변(immutability)이 꺼져 있으면 취약합니다.', '1️⃣ Amazon Elastic Container Service → 프라이빗 리포지토리 → 권한
 - 리포지토리 정책에 리소스에 접근할 Principal을 지정하고, IAM 계정별로 Push/Pull 권한이 분리되었는지와, 이미지 스캔과 태그 불변(immutability)을 활성화해야 합니다.', '기존 CI/CD 파이프라인이 실패하거나 Cross-Account 배포에 역할 위임/허용 목록 구성이 추가되어 운영이 복잡해질 수 있습니다.', '', '2025-10-20 16:33:27.672589', '2025-10-20 16:33:27.672589', 2);
INSERT INTO public.guidelines VALUES (35, 'SendCommand(RunCommand)를 통한 EC2에서의 악성 셸 명령 실행', 1, 15, '긴급', 'AWS Systems Manager의 RunCommand 기능은 EC2 인스턴스에 스크립트나 명령을 비대화형으로 전송할 수 있는 기능입니다.
RunCommand를 실행할 수 있는 권한인 SendCommand 권한을 실행 액션 권한을 확보하면, 서버에 명령을 전송할 수 있어 대규모 데이터 탈취, 로그 삭제, 랜섬 행위 등 공격에 활용될 수 있습니다.', '공격자가 SendCommand 권한을 확보하면, EC2 인스턴스에 AWS-RunShellScript와 같은 악성 스크립트를 전송하고 실행해 비밀값을 압축한 후 외부로 업로드하거나 원격 셸을 띄워 접근 수단을 확보하고, 증적을 제거해 탐지 및 조사를 어렵게 만들 수 있습니다. 이로 인해 데이터 유출, 권한 확산, 서비스 중단, 백도어 설치 등 심각한 피해로 이어질 수 있습니다.', '🧭 IAM → 정책 → [정책명] → 정책 편집
 ↳ ⚠️ ssm:SendCommand가 Principal:""*"" 또는 Resource:""*""로 허용되어 있거나, 대상 인스턴스 제한(태그/리소스 ARN 조건) 없이 임의 인스턴스에 AWS-RunShellScript/AWS-RunPowerShellScript 실행이 가능하면 취약합니다.', '1️⃣ IAM → 정책 → [정책명] → 정책 편집
 - ssm:SendCommand 권한을 실행 대상의 구체적 리소스 ARN(예: 특정 인스턴스 ARN, 특정 Document ARN)으로 제한해야 합니다.', '명령 실행이 정책 또는 허용 목록에 막혀 긴급 조치가 지연될 수 있습니다.', '', '2025-10-20 16:34:35.726683', '2025-10-20 16:34:35.726683', 2);
INSERT INTO public.guidelines VALUES (36, 'SSM 문서 공개 설정으로 인한 자격 증명 노출', 1, 15, '중요', 'AWS Systems Manager는 클라우드 자원에 대한 자동화 작업을 정의하는 문서(SSM Document)를 생성할 수 있습니다. 기본적으로 이러한 문서는 비공개로 설정되지만, 실수로 공개되거나 다른 AWS 계정과 공유될 수 있습니다. 문서에는 내부 자원 정보, 배포 절차, 백업 방식 등 민감한 정보가 포함될 수 있으며, 이는 공격자에게 유용한 정보를 제공합니다.', '공격자는 공개된 SSM 문서를 검색하여 그 내용을 분석합니다. 문서에 액세스 키, 사용자 이름, 이메일 주소 등의 민감한 정보가 하드코딩되어 있으면, 이를 통해 공격자는 계정에 접근하거나 크리덴셜 스터핑을 시도할 수 있습니다.', '🧭 AWS Systems Manager → 문서 → 문서 선택 → 세부정보
 ↳ ⚠️ SSM 문서 권한이 퍼블릭으로 열려 있으면 취약합니다.', '1️⃣ AWS Systems Manager → 문서 → 문서 선택 → 세부정보
 - SSM 문서 권한을 프라이빗으로 설정한 뒤 저장해야 합니다.', '공유/협업을 위해 공개 문서에 의존하던 자동화가 중단되고, 타 계정/조직 간 공통 문서 재사용성이 낮아질 수 있습니다.', '', '2025-10-20 16:35:21.937211', '2025-10-20 16:35:21.937211', 2);
INSERT INTO public.guidelines VALUES (37, 'GuardDuty 비활성화로 인한 위협 탐지 실패', 1, 16, '중요', 'GuardDuty는 계정/리전 전반에서 VPC 플로우/CloudTrail 관리/S3 데이터 이벤트/DNS 로그 등을 상시 분석해 위협을 탐지하는 기본 방어선입니다. GuardDuty가 활성화되어 있지 않거나 조직 단위로 배포/자동 활성화되지 않으면 이러한 이상 징후를 놓쳐 초기 침해를 식별/차단하지 못해 공격자가 장기간 잠복 활동할 수 있기 때문에 위험합니다.', 'GuardDuty를 사용하지 않으면, AWS 계정과 리소스에서 발생하는 비정상 행위나 침해 징후를 실시간으로 감지하지 못해, 공격자가 장기적으로 내부에 머무르며 활동할 가능성이 커집니다.
결과적으로 자격증명 탈취, 권한 상승, 데이터 유출, 암호화폐 채굴 등이 일어나도 탐지/대응이 늦어져 피해 규모가 기하급수적으로 커질 수 있습니다.', '🧭  GuardDuty → 계정
 ↳ ⚠️ 일부 계정/리전에서 비활성화이거나 신규 계정이 자동으로 GuardDuty에 등록되지 않으면 취약합니다.', '1️⃣ GuardDuty → 계정
 - 관리자 계정에서 모든 멤버 계정과 모든 사용 리전에 일괄 활성화되어 있으며 신규 계정 자동 가입이 설정되어 있어야 합니다.', '', '', '2025-10-20 16:36:15.93191', '2025-10-20 16:36:15.93191', 2);
INSERT INTO public.guidelines VALUES (38, 'Cognito Identity Pool에 연결된 IAM Role의 과도 권한', 1, 17, '중요', 'Cognito Identity Pool은 인증된(또는 인증되지 않은) 사용자를 IAM 역할과 매핑하여 임시 AWS 자격증명을 발급하므로, 연결된 역할에 iam:PassRole, kms:Decrypt, sts:AssumeRole의 과도한 권한이 있으면 인증된 사용자 또는 익명 사용자가 즉시 광범위한 AWS 리소스에 접근할 수 있습니다.', '공격자가 취약한 User Pool에 가입하거나 유효한 ID 토큰을 획득하면, get-id에서 get-credentials-for-identity 흐름으로 임시 자격증명을 받아 S3, DynamoDB, Lambda 등 역할이 허용한 모든 API를 호출할 수 있습니다.
따라서 과도 권한의 역할이 할당된 Identity Pool이 침해되면 단일 사용자의 인증으로부터 데이터 탈취/리소스 조작/심지어 권한 상승까지 발생할 수 있습니다.', '🧭 Amazon Cognito → 자격증명 풀 → [해당 자격증명 풀] → 사용자 엑세스 탭 → 자격 증명 공급자 → 역할선택 - 기본역할 → 역할 편집 → IAM 콘솔 → 권한 정책 → 해당 역할 편집 → 권한
 ↳ ⚠️ Authenticated/Unauthenticated에 연결된 IAM 역할 정책에 Action:""*"" 또는 Resource:""*""이 포함되어 있거나 iam:*, sts:AssumeRole, kms:Decrypt 등 높은 권한이 불필요하게 부여되어 있거나, 익명(Unauthenticated) 역할에 민감 리소스 접근 권한이 허용되어 있으면 취약합니다.
', '1️⃣ Amazon Cognito → 자격증명 풀 → [해당 자격증명 풀] → 사용자 엑세스 탭 → 자격 증명 공급자 → 역할선택 - 기본역할 → 역할 편집 → IAM 콘솔 → 권한 정책 → 해당 역할 편집 → 권한
 - Authenticated/Unauthenticated에 연결된 IAM 역할 정책에 Action:""*"" 또는 Resource:""*""이 포함되어 있지 않아야 하고, iam:*, sts:AssumeRole, kms:Decrypt 등 높은 권한은 실제 필요 시에만 최소 권한으로 부여되어야 하며, 익명(Unauthenticated) 역할에는 민감 리소스에 대한 접근 권한을 부여하지 않아야 합니다.', '축소된 권한으로 인해 역할 정책에서 실제 애플리케이션이 사용하는 API 권한이 제거되어 서비스 오류가 발생할 수 있습니다.', '', '2025-10-20 16:37:49.02633', '2025-10-20 16:38:43.344775', 2);
INSERT INTO public.guidelines VALUES (39, 'Cognito Self-sign-up 허용으로 인한 비인가 계정 생성 위험', 1, 17, '확인요망', 'Cognito Self-sign-up을 허용하면 외부의 누구나(스팸/봇/공격자 포함) 사용자 계정을 생성할 수 있으므로, 악성 계정이 대량으로 생성되어 서비스 오용/스팸/브루트포스/자격증명 남용의 발판이 됩니다.
또한 이메일/전화번호 검증이나 관리 승인 절차가 없으면 비인가자가 쉽게 인증 토큰을 받아 애플리케이션 로직을 악용할 수 있습니다.', '공격자가 대량으로 계정을 생성해 인증 토큰을 획득하면, 그 토큰으로 유료/리소스 집약적 API 호출을 남용하거나 서비스 기능을 악용해 비용과 자원을 소모시킬 수 있습니다.
또한 해당 User Pool이 Identity Pool과 연계되어 있고 매핑된 역할에 과도한 권한이 있으면, 획득한 인증 토큰을 임시 자격증명으로 교환해 S3/Lambda/KMS 등 클라우드 자원에 대한 비인가 작업으로 확대될 수 있습니다.', '🧭 Cognito → 사용자 풀 → 점검할 User Pool → 가입 → 셀프 서비스 가입 편집
 ↳ ⚠️ 해당 서비스가 내부 전용이거나 관리자만 계정을 발급해야 하는 보안 요구사항이 있는 경우, User Pool에서 Self sign-up을 활성화하면 취약할 수 있습니다.', '1️⃣ Amazon Cognito → 사용자 풀 → [해당 사용자 풀] → 가입 → 셀프 서비스 가입 편집
 - 해당 서비스가 내부 전용이거나 관리자 계정만 발급해야 하는 경우 셀프 서비스 가입의 셀프 등록을 비활성화해야 합니다.', '비활성화 시 정상 사용자의 가입 절차가 중단될 수 있고, 오프라인 또는 게스트 기능을 제공하던 일부 서비스가 동작하지 않을 수 있습니다.', '', '2025-10-20 16:38:32.114509', '2025-10-20 16:38:32.114509', 2);
INSERT INTO public.guidelines VALUES (40, 'Cognito 토큰 클레임 신뢰 오류로 인한 계정 하이재킹', 1, 17, '확인요망', 'Cognito가 발급하는 JWT(JSON Web Token)의 access_token은 발급 시점의 클레임(사용자/권한/만료 등 속성)을 포함합니다. 공격자가 Cognito API로 자신의 유저 속성(예: email)을 변경하면 User Pool의 유저 레코드는 즉시 갱신됩니다.
하지만 발급된 access_token은 여전히 이전 이메일을 담고 있어, 이 토큰을 사용하면 이전 값을 볼 수 있습니다. refresh_token으로 새 토큰을 발급받으면, Cognito는 현재 사용자 속성을 반영해 새 토큰을 생성하고 토큰 내 email은 공격자 의도대로 바뀐 값으로 나타납니다.', '애플리케이션이 토큰의 email을 신뢰해 유저 레코드를 조회하면, 새 토큰을 발급하고 공격자 의도대로 email이 변경되며, 피해자 계정으로 매핑되어 탈취될 수 있습니다. 이로 인해 피해자 계정으로 로그인하거나 계정 하이재킹으로 이어질 수 있습니다. 또한 토큰 검증이 느슨하고(iss/aud/exp/서명 미검증) 토큰 수명이 길거나 권한 범위가 과도하면, 토큰 탈취 시 장시간 및 광범위한 데이터 열람/변조가 가능하며, refresh_token이 남아 있으면 지속 접근(세션 재발급)도 확보될 수 있습니다.', '🧭 Amazon Cognito → 사용자 풀 → 사용자 풀 선택 → 앱 클라이언트 → 앱 클라이언트 선택 → 토큰 유효기간
 ↳ ⚠️ 갱신/액세스/ID 토큰 만료 시간이 애플리케이션 운영에 필요한 최소한의 시간보다 길게 설정되어 있으면 취약합니다. (예: 액세스/ID 토큰은 15분~60분, 갱신 토큰은 7일~30일 → 기준은 조직 정책에 따라 정의)', '1️⃣ Amazon Cognito → 사용자 풀 → 사용자 풀 선택 → 앱 클라이언트 → 앱 클라이언트 선택 → 토큰 유효기간
 - 갱신/액세스/ID 토큰 만료 시간이 애플리케이션 운영에 필요한 최소한의 시간으로 설정해야 합니다. (예: 액세스/ID 토큰은 15분~60분, 갱신 토큰은 7일~30일 → 기준은 조직 정책에 따라 정의)', 'access_token 만료가 너무 짧을 경우, 사용자가 자주 로그아웃되거나 “세션이 만료되었습니다” 메시지를 자주 보게 됩니다. 또한 토큰이 자주 만료되면 refresh_token 요청 빈도가 폭증합니다.', '', '2025-10-20 16:39:34.480616', '2025-10-20 16:39:34.480616', 2);
INSERT INTO public.guidelines VALUES (41, 'CloudFormation의 PassRole으로 인한 권한 상승', 1, 18, '중요', 'CloudFormation은 스택 실행 시 호출 주체가 PassRole로 지정한 실행 역할(RoleARN)의 권한으로 리소스를 만들고 바꿉니다. 따라서 CreateStack 요청에 고권한 역할을 전달하면, CloudFormation이 그 역할을 대신 사용해 권한 상승과 IAM 리소스 생성까지 수행할 수 있습니다.', '공격자는 노출된 키/권한으로 cloudformation:CreateStack을 실행해 악의적 템플릿을 배포하고, 템플릿에서 관리자 권한을 가진 실행 역할을 PassRole하여 새 사용자나 자격증명을 생성/회수하게 해 계정 전반에 대한 영속적인 접근을 확보합니다.
그 결과 공격은 단일 취약점에서 빠르게 계정 전체로 권한을 넓혀 다른 서비스로 침투할 수 있습니다.', '🧭 IAM → Roles(또는 Users) → 대상 주체 선택 → Permissions → 정책 수정/추가
 ↳ ⚠️ 하나의 IAM 역할에 Cloudformation:CreatStack, iam:PassRole 두 가지 권한이 모두 있고, 그 리소스 범위가 ""Resource"": ""*""으로 되어 있다면 취약합니다.', '1️⃣ IAM → 정책 → [해당 정책] → 편집
 - 하나의 IAM 역할에 CloudFormation:CreateStack 및 iam:PassRole 권한이 동시에 부여되어 있지 않거나, 해당 권한의 리소스 범위가 ""Resource"": ""*""이 아니라 특정 실행 역할 ARN으로 명시적으로 제한되어있어야 합니다.', '기존 CI/CD 및 자동화가 권한 부족으로 실패하여 배포 중단/서비스 장애가 발생할 수 있습니다.', '', '2025-10-20 16:40:53.06362', '2025-10-20 16:40:53.06362', 2);
INSERT INTO public.guidelines VALUES (42, 'OpenSearch 도메인 공개 접근 및 광범위 권한 정책으로 인한 데이터 유출', 1, 19, '중요', 'OpenSearch 도메인이 퍼블릭으로 직접 노출되어 있거나, 보안 설정이 비활성화되어 있으면, 누구나 데이터를 조회/검색/삭제 및 덮어쓸 수 있게 됩니다. 이렇게 되면 공격자는 저장된 비밀번호/토큰/백업 정보 등을 내려받아 계정 전체를 장악하거나, 악성 쿼리로 시스템을 느려지게 하거나, 저장된 데이터 자체를 바꿔버려 사용자에게 악성코드를 보내게 만들 수도 있습니다.', '공격자는 공개된 도메인에 대해 인덱스 조회, 관리 API 호출을 시도하여 민감한 로그와 사용자의 개인정보를 수집하거나, 인덱스 매핑을 변경/삭제할 수 있습니다.
또한 퍼블릭 도메인에서 얻은 정보를 바탕으로 추가 내부 침투 및 권한 획득으로 이어질 수 있습니다.', '🧭 OpenSearch Service → Domains → 점검할 도메인 선택 → 보안 구성 → 액세스 정책
 ↳ ⚠️ 도메인의 Network 설정이 Public access(인터넷 노출)로 되어 있거나, Access Policy JSON에 ""Principal"":""*"" 또는 모든 IAM 주체에 es:* / es:ESHttp*  광범위 권한을 부여하는 문구가 포함되어 있으면 취약합니다.', '1️⃣ Amazon OpenSearch → 도메인 → 도메인 생성
 - Access Policy를 IP(관리자 고정 IP/CIDR) 또는 특정 IAM Role/User로만 제한하고, Principal을 ""*""로 두지 않아야 합니다.
 - 도메인을 VPC 전용(VPC access) 으로 전환합니다.', '외부에서 직접 접속하던 Dashboards/애플리케이션 워크플로가 중단될 수 있으며, 운영자 접근 경로도 복잡해져 운영 효율성이 저하될 수 있습니다.', '', '2025-10-20 16:41:37.263865', '2025-10-20 16:41:37.263865', 2);
INSERT INTO public.guidelines VALUES (43, 'Elastic Beanstalk 환경 속성/애플리케이션 번들 내 민감정보 노출로 인한 데이터 유출', 1, 20, '확인요망', 'Elastic Beanstalk는 애플리케이션 배포를 간편하게 해주는 관리형 플랫폼이지만, 환경 속성에 비밀번호, API 키, 토큰, 인증서와 같은 민감정보들이 남기 쉬워 민감정보나 자격증명이 노출될 수 있습니다.
Elastic Beanstalk 환경은 여러 AWS 리소스를 자동으로 생성하고 관리하므로 한 곳의 실수가 계정 전체로 권한을 넓혀 다른 서비스로 침투할 수 있습니다.', '개발자가 DB 비밀번호나 AWS 키를 환경 속성으로 넣어 배포하게 되면, 공격자는 Elastic Beanstalk API/CLI로 환경 설정과 애플리케이션 버전의 환경 속성 위치를 읽어 내려받을 수 있게 됩니다. 획득한 자격증명으로 S3 버킷, RDS, IAM과 같은 추가 리소스를 조회 및 조작해 데이터 유출, 권한 상승, 백도어 등으로 확장할 수 있게 되고, Elastic Beanstalk 인스턴스의 IMDS 취약점이 남아있다면 메타데이터에서 임시 자격증명을 탈취할 수 있습니다.', '🧭 Elastic Beanstalk → Applications → 해당 Application → 환경 → 점검할 환경 → 구성→ 환경 속성
 ↳ ⚠️ 환경 속성(Environment properties)에 DB 비밀번호, AWS_ACCESS_KEY_ID/AWS_SECRET_ACCESS_KEY 같은 자격증명이 평문으로 들어있으면 취약합니다.', '1️⃣ Elastic Beanstalk → 환경 생성
 - Elastic Beanstalk에서 환경 생성 시, 환경 속성 속 민감 정보는 Secrets Manager / SSM Parameter Store로 사용해야 합니다.', '', '', '2025-10-20 16:42:31.688668', '2025-10-20 16:42:31.688668', 2);
INSERT INTO public.guidelines VALUES (44, 'Redshift 클러스터 암호화 미설정으로 인한 운영/보안 리스크', 1, 21, '중요', 'Amazon Redshift는 2025년부터 기본적으로 암호화 활성화(KMS 사용)와 보안 기본값 강화가 적용되었지만, 기존(레거시) 클러스터/스냅샷이나 일부 복원/워크플로우는 여전히 비암호화 상태로 남아 있을 수 있습니다. 점검 주기가 느슨하면 “새로 생성된 건 안전하겠지”라는 가정때문에 과거 리소스가 사각지대가 되고, 스냅샷/백업 유출 시 평문 데이터 노출로 이어집니다.', '과거 비암호화 클러스터에서 만들어진 스냅샷은 이후에도 계속 비암호화 상태로 유지됩니다. S3에 저장되는 해당 스냅샷이 외부로 노출될 경우, KMS 복호화 절차 없이 즉시 평문으로 접근 가능하며 이를 통해 내부 계정 탈취, S3 퍼블릭 정책 오류, 외부 공유 실수 등과 결합될 때 데이터 유출로 직결됩니다. AWS 콘솔 상에서는 안전해 보이지만, 실제 백업 계층에서 완전한 평문 노출 위험이 존재합니다.', '🧭 Redshift 콘솔 → Clusters → (대상 선택) → Properties → Database configurations → Encryption
 ↳ ⚠️ Cluster의 Encryption = Disabled(비암호화)이면 취약합니다.

🧭 Redshift 콘솔 → Snapshots 에서 각 스냅샷의 Encryption
 ↳ ⚠️ 스냅샷이 Unencrypted로 표시되어 있으면 취약합니다.', '1️⃣ Redshift 콘솔 → 클러스터 → (대상 선택) → Properties → Database configurations → Encryption
 - Edit encryption으로 전환해 클러스터 암호화를 활성화해야 합니다.', 'Redshift 클러스터를 암호화로 전환하면 내부적으로 새 암호화된 클러스터로 데이터를 마이그레이션하기 때문에, 전환 과정에서 일시적인 성능 저하나 연결 중단이 발생할 수 있습니다. 또한 마이그레이션 작업 중에는 클러스터를 읽기 전용 모드로만 사용 가능합니다.', '💡 2025년 변경으로 신규 생성의 기본값은 KMS 암호화지만, 과거 리소스/일부 복원 경로는 예외가 존재합니다.(스냅샷 복원 기본값 주의)', '2025-10-20 16:43:41.172498', '2025-10-20 16:43:41.172498', 2);
INSERT INTO public.guidelines VALUES (45, 'Glue 개발 엔드포인트 생성/수정 시 PassRole을 통한 권한 상승', 1, 22, '중요', 'Glue DevEndpoint는 개발용 원격 실행환경을 생성할 수 있고, 생성 시 실행 역할(Execution Role)을 전달합니다. 따라서 호출 주체가 glue:CreateDevEndpoint 또는 glue:UpdateDevEndpoint 권한과 함께 iam:PassRole 권한을 보유하면, 악의적 템플릿이나 요청으로 고권한 실행 역할을 DevEndpoint에 전달해 권한 상승 및 민감 리소스에 접근할 수 있습니다.', '공격자는 탈취한 자격증명으로 glue:CreateDevEndpoint를 실행해 자신이 전달한 실행 역할로 환경을 띄우고, 그 환경에서 크리덴셜 수집/비밀 탈취/백도어 설치/권한 생성 등 임의 코드를 실행합니다. 이후 획득한 권한으로 S3, Secrets Manager, RDS 등 민감 자원에 접근하거나 추가 권한을 생성해 계정 내 권한 상승/영속화를 달성할 수 있습니다.', '🧭 IAM → 역할 → 대상 주체 선택 → Permissions → 정책 수정/추가
 ↳ ⚠️ glue:CreateDevEndpoint와 iam:PassRole을 같은 주체에, Resource:""*""로 주면 취약합니다.', '1️⃣ IAM → 역할 → 대상 주체 선택 → Permissions → 정책 수정/추가
 - 하나의 역할에 두 권한(glue:CreateDevEndpoint, iam:PassRole)을 동시에 부여하지 않고, iam:PassRole은 특정 역할 ARN으로 제한하며, iam:PassedToService 조건으로 대상 서비스를 Glue로 한정해야 합니다.', '합법적 개발 및 디버깅 워크플로가 중단될 수 있으므로 파이프라인/운영 절차 조정과 예외 관리가 필요합니다.', '', '2025-10-20 16:44:33.280647', '2025-10-20 16:44:33.280647', 2);
INSERT INTO public.guidelines VALUES (46, 'Service Catalog 관리자 권한 탈취 시 Launch Constraint 악용으로 IAM 권한 상승', 1, 23, '중요', 'AWS Service Catalog의 Launch Constraint은 제품을 실행할 때 Service Catalog가 대신 맡아 수행할 IAM 역할(launch role)을 지정합니다. 이 역할은 제품이 생성하는 리소스들을 만들고 수정할 수 있는 권한을 가지므로, 이 역할에 과도한 권한이 있거나 콘솔/API 조작으로 이 제약을 악용할 수 있다면 낮은 권한의 사용자가 높은 권한을 획득할 수 있습니다.', '공격자는 악성 Service Catalog 제품을 만들어(또는 외부에서 공유된 포트폴리오를 사용해) 해당 제품이 실행될 때 Launch Constraint 역할을 통해 IAM 사용자/역할을 생성하거나 관리자 권한을 부여하도록 템플릿을 설계할 수 있습니다. 그런 다음 타깃 계정의 Service Catalog 관리자 권한을 이용해 포트폴리오를 수락/연결하면, 정상적인 배포 절차를 통해 즉시 영구적 접근/권한 상승을 확보할 수 있습니다.', '🧭 Service Catalog → 포트폴리오 → 해당 포트폴리오 선택 → 공유
 ↳ ⚠️ Portfolio 공유 설정을 계정 간 공유로 선택할 할 경우 AcceptPortfolioShare 같은 API 호출에 취약합니다.

🧭 AWS Organizations → 좌측 메뉴 Policies → Service control policies → Create Policy
 ↳ ⚠️ 어떤 계정/역할이든 포트폴리오 수락이 가능하고, 수락 절차가 자동화되어 있으면 취약합니다.

🧭 Service Catalog → 포트폴리오 → 해당 포트폴리오 선택 → 제약 조건 생성 → IAM 역할 선택
 ↳ ⚠️ 시작 제약 조건에 지정된 IAM Role이 과도한 권한을 가지게 될 경우에 취약합니다.', '1️⃣ Service Catalog → 포트폴리오 → 해당 포트폴리오 선택 → 공유
 - 포트폴리오 공유를 조직 구조 내에서 공유 방법으로 선택합니다.

2️⃣ AWS Organizations → AWS 계정  → 관리 계정 → 정책 → 연결 → 정책 생성
 - 조직 전체에 servicecatalog:AcceptPortfolioShare 액션을 Deny 하는 정책을 생성합니다.

3️⃣ Service Catalog → 포트폴리오 → 해당 포트폴리오 선택 → 제약 조건 생성 → IAM 역할 선택
 - Launch Role을 할당받도록 하는 주체 지정, 호출 출처를 제한하며 iam:*, iam:CreatePolicy, iam:AttachRolePolicy, iam:PassRole 같은 IAM 관련 고위험 권한은 허용하지 않도록 합니다.', '기존에 개별 계정에서 승인하던 워크플로가 중단될 수 있으므로 사전에 조직 공유 설계 및 테스트를 반드시 수행해야 합니다.', '', '2025-10-20 16:45:26.436168', '2025-10-20 16:45:26.436168', 2);
INSERT INTO public.guidelines VALUES (47, 'DocumentDB 스냅샷 공개 오설정으로 인한 데이터 노출', 1, 24, '중요', 'Amazon DocumentDB(MongoDB 호환 관리형 DB)는 수동 스냅샷을 계정 간 공유하거나 퍼블릭으로 공개할 수 있습니다. 스냅샷을 공개하면 스냅샷에 포함된 데이터(문서, 설정, 사용자 계정 등)가 누구에게나 복원 및 열람이 가능해져 민감정보와 자격증명 유출로 직결됩니다.', '공격자는 공개된 수동 스냅샷을 찾아 자신의 계정으로 복원한 뒤 내부 데이터를 전부 열람하고 추출해 비밀번호, API 키, 개인정보 등 민감한 항목들을 수집합니다. 이로 인해 서비스 계정 탈취, 데이터 유출, 규제, 평판 피해 및 추가 침해로 빠르게 확산될 수 있습니다.', '🧭 Amazon DocumentDB → Snapshots → DB cluster snapshots 또는 Manual snapshots → 점검할 스냅샷 → Actions → Share snapshot 확인
 ↳ ⚠️ 스냅샷의 restore(공유) 속성이 Public이면 취약합니다.

🧭 AWS Console → KMS → Customer managed keys → (키 선택) → Key Policy / Grants
 ↳ ⚠️ 스냅샷이 KMS로 암호화되어 있지 않으면 취약합니다.', '1️⃣ DocumentDB → 스냅샷 → 스냅샷 공유
 - 스냅샷의 restore(공유) 속성을 Private으로 설정합니다.

2️⃣ DocumentDB → 클러스터 → 클러스터 생성 → 고급 설정 표시
 - 스냅샷을 만들 클러스터는 KMS로 암호화해야 합니다.', '공개 스냅샷 제거 및 암호화된 복사본 생성/원본 삭제 조치로 인해, 해당 공개 스냅샷에 의존하던 자동 복원/테스트 파이프라인과 외부 파트너의 접근이 즉시 차단되어 정상적인 복구 및 테스트 프로세스가 중단될 수 있습니다.', '💡 DocumentDB는 클러스터 생성 시, CMK 기반 저장 자동 암호화를 권고합니다.', '2025-10-20 16:46:35.886423', '2025-10-20 16:46:35.886423', 2);
INSERT INTO public.guidelines VALUES (48, 'Bedrock의 과도한 접근 권한으로 인한 LLM 서비스 남용 위험', 1, 25, '중요', '자격증명이 유출되면 곧바로 Bedrock LLM 호출 및 배포 권한으로 악용될 수 있습니다. 특히 Bedrock에 과도한 권한이 부여되어 있으면 탈취된 키로 대량 모델 호출/모델 프로비저닝/설정 변경이 즉시 가능해 비용이 급증하고, 입출력에 포함된 민감정보가 외부로 유출되며 권한 확대로 이어질 수 있습니다.', '공격자는 탈취한 액세스 키나 자동화 계정으로 Bedrock 같은 LLM 런타임을 호출하거나 모델 인스턴스를 프로비저닝해 대량 API 호출로 비용을 폭증시키고, 모델 입출력을 통해 민감 데이터를 주입/추출해 외부 유출을 일으킵니다.
또한 LLM 호출 권한을 악용해 프롬프트 인젝션, 외부 API 연동 조작, 모델 파이프라인 변조 등을 수행하면 탐지를 회피하며 비용, 데이터, 권한 관점에서 2차 피해로 빠르게 확산될 수 있습니다.', '🧭 IAM → BedRock을 호출할 사용자 혹은 역할 선택 → 정책 추가
 ↳ ⚠️ IAM 정책에 bedrock:InvokeModel 또는 bedrock:List* 등 권한이 Resource:""*"" 또는 조건 없이 광범위하게 허용되어 있으면 취약합니다.', '1️⃣ IAM → BedRock을 호출할 사용자 혹은 역할 선택 → 정책
 - Bedrock 모델 활성화/호출 계열 API 권한은 특정 모델 ARN(또는 허용 모델 목록)과 호출 리전/주체 조건으로만 명시적으로 제한되어 있어야 합니다.', '정당한 사용자의 호출/로깅/배포 API가 차단되어 개발과 테스트가 지연될 수 있습니다. 또한 연구/운영팀이 매번 수동으로 예외 승인을 요청해야해 생산성이 저하되고, 모델 운영 자동화나 파이프라인 연동이 중단될 수 있습니다.', '', '2025-10-20 16:47:34.274853', '2025-10-20 16:47:34.274853', 2);
INSERT INTO public.guidelines VALUES (49, 'SES 접근 권한 과다로 인한 대량 피싱/스팸 발송 위험', 1, 26, '중요', 'SES의 발신자 검증, 샌드박스 해제와 발송 권한은 대량 이메일 발송을 즉시 가능하게 합니다. 따라서 이 권한이 광범위하게 부여되면 내부 실수나 탈취된 자격증명을 통해 대규모 피싱 및 스팸 캠페인이 진행될 수 있습니다.', '공격자가 광범위한 권한으로 PutAccountDetails 등을 통해 샌드박스를 해제하고, CreateEmailIdentity/VerifyDomainIdentity로 발신자를 등록/검증합니다. 이후 SendEmail/SendRawEmail을 대량 호출해 피싱 캠페인을 전개합니다. 이로 인해 사용자 자격증명 탈취/평판 하락/발신 도메인의 블랙리스트 등록/예기치 않은 비용 폭증으로 이어질 수 있습니다.', '🧭 IAM → 사용자 / 역할 / 정책 → 각 주체 선택 → Permissions 탭에서 SES 관련 정책
 ↳ ⚠️ 어떤 사용자/역할/그룹에 Action이 ses:* 이거나 ses:SendEmail, ses:SendRawEmail, ses:PutAccountDetails, ses:PutAccountSendingAttributes, ses:CreateEmailIdentity, ses:VerifyDomainIdentity 등 고위험 SES 액션이 포함되어 있고 Resource:”*”이면 취약합니다.', '1️⃣ IAM → Users / Roles / Groups → 각 주체 선택 → Permissions 탭에서 SES 관련 정책
 - SES 관련 고위험 액션(예: ses:SendEmail, ses:SendRawEmail, ses:PutAccountDetails, ses:PutAccountSendingAttributes, ses:CreateEmailIdentity, ses:VerifyDomainIdentity 등)은 승인된 관리자 또는 서비스 전용 IAM 역할에만 허용되어야 하며, 리소스는 가능한 경우 구체적인 ARN/도메인/아이덴티티로 제한하고, 리소스 수준 제약이 불가능한 액션은 IAM 조건 및 최소 권한 원칙으로 통제해야 합니다.', '리소스 수준 제약을 지원하지 않는 액션이 많아 Condition 의존도가 높아지고, 그 결과 정책 관리/운영이 복잡해져서 오탐/미차단 위험이 커집니다.', '', '2025-10-20 16:48:22.238495', '2025-10-20 16:48:22.238495', 2);
INSERT INTO public.guidelines VALUES (50, 'AppStream 2.0 환경을 통한 과도한 권한 및 자격 증명 탈취', 1, 27, '확인요망', 'AppStream 2.0은 클라우드에서 데스크톱/애플리케이션을 실행하고 화면만 스트리밍하는 서비스라서 앱은 AWS 인프라 내부에서 실행됩니다.
AppStream이 특정 IAM 역할을 맡아 인스턴스에서 AWS API를 호출하도록 구성될 수 있는데, 그 역할의 신뢰 정책 또는 권한이 과도하면 공격자는 해당 역할을 발판으로 계정 내 권한을 확대할 수 있습니다.', '공격자가 AppStream 관련 역할의 신뢰 정책을 조작하면(또는 과도한 권한을 가진 역할을 AppStream에 연결), 스트리밍 인스턴스에서 실행되는 프로세스(이미지 빌더 스크립트나 세션 스크립트 등)를 통해 임시 자격증명으로 AWS API를 호출해 데이터 탈취/리소스 생성/권한 상승을 할 수 있습니다.', '🧭 AppStream 2.0 → Fleets → 점검할 Fleet → Details(또는 Compute resources / Service role) → 연결된 IAM role (service role / instance role)
 ↳ ⚠️ AdministratorAccess 또는 광범위 권한을 Resource:""*""로 허용하면 취약합니다.
 ↳ ⚠️ iam:PassRole/sts:AssumeRole 권한 사용 시 특정 IAM Role의 ARN으로 지정하지 않거나 Condition으로 구체적인 조건을 지정하여 사용하지 않으면 취약합니다.', '1️⃣ AppStream 2.0 → Fleets → 점검할 Fleet → Details(또는 Compute resources / Service role) → 연결된 IAM role (service role / instance role)
 - Fleet/이미지 빌더에 연결된 역할의 권한에서 Resource는 특정 IAM Role의 ARN으로만 한정해야 합니다.
 - iam:PassRole 권한 사용 시 특정 IAM Role의 ARN만 허용되도록 Resource를 지정하고, Condition을 활용하여 빌더가 사용할 VPC를 특정하고 역할이 전달될 수 있는 서비스를 한정하는 등의 방식을 사용합니다.', 'Fleet이나 Image Builder가 여러 리전 또는 다양한 버전의 AMI, 스택 구성을 사용할 때 각 환경마다 다른 Role ARN을 사용한다면, 권한 정책을 Role별로 세밀하게 지정해야 하기에 운영 및 유지보수가 복잡해질 수 있습니다.', '', '2025-10-20 16:49:00.083423', '2025-10-20 16:49:00.083423', 2);


--
-- Data for Name: checklists; Type: TABLE DATA; Schema: public; Owner: -
--

INSERT INTO public.checklists VALUES (1, 1, 1, 1, 'EC2 인스턴스 메타데이터 옵션의 IMDSv2를 필수로 선택', true, '2025-10-20 17:08:53.105071', '2025-10-20 17:08:53.105071', 2);
INSERT INTO public.checklists VALUES (2, 1, 1, 2, '민감 정보가 안전하게 보관(ex. 환경변수에 민감정보를 평문 저장하지 말고 Secrets Manager에서 보안 암호 형태로 저장)', true, '2025-10-20 02:01:02.30208', '2025-10-20 02:01:02.30208', 2);
INSERT INTO public.checklists VALUES (3, 1, 1, 3, 'EC2 AMI 가용성이 프라이빗으로 설정', true, '2025-10-20 02:01:14.040768', '2025-10-20 02:01:14.040768', 2);
INSERT INTO public.checklists VALUES (4, 1, 1, 4, 'Organizations SCP 정책 설정에서 사전 허용된 계정 목록의 AMI만 리스트에 등록', true, '2025-10-20 02:01:24.909469', '2025-10-20 02:01:24.909469', 2);
INSERT INTO public.checklists VALUES (5, 1, 1, 5, '보안그룹 인바운드 규칙이 원격(SSH, RDP), DB, 관리 포트 소스의 CIDR을 좁은 범위(/16~)로 설정', true, '2025-10-20 02:02:06.07526', '2025-10-20 02:02:06.07526', 2);
INSERT INTO public.checklists VALUES (6, 1, 1, 6, 'EBS 스냅샷의 공유 옵션이 프라이빗으로 설정', true, '2025-10-20 02:02:23.405917', '2025-10-20 02:02:23.405917', 2);
INSERT INTO public.checklists VALUES (7, 1, 2, 7, '퍼블릭 용도의 S3 버킷이 아닐 경우, 모든 퍼블릭 액세스 차단 활성화', true, '2025-10-20 17:31:35.878305', '2025-10-20 17:31:35.878305', 2);
INSERT INTO public.checklists VALUES (8, 1, 2, 7, 'S3 버킷 정책 속 Principal이 특정 ARN으로 제한되어 있고 Resource는 버킷 안 특정 폴더로 지정', true, '2025-10-20 17:32:50.357489', '2025-10-20 17:32:50.357489', 2);
INSERT INTO public.checklists VALUES (9, 1, 2, 8, 'S3 ACL 설정 속 모든 사람, 인증된 사용자 그룹의 나열, 읽기, 쓰기 권한 체크 해제', true, '2025-10-20 17:33:20.181934', '2025-10-20 17:33:20.181934', 2);
INSERT INTO public.checklists VALUES (10, 1, 2, 8, 'S3 ACL의 Grantee 목록에 12자리 숫자(외부 AWS 계정 ID)가 있으면 해당 공유를 검증', true, '2025-10-20 17:33:55.451722', '2025-10-20 17:33:55.451722', 2);
INSERT INTO public.checklists VALUES (11, 1, 2, 9, 'S3 복제 규칙에 사용되는 대상 버킷 정책 속 Resource에 대상 버킷 ARN 지정', true, '2025-10-20 17:34:10.890278', '2025-10-20 17:34:10.890278', 2);
INSERT INTO public.checklists VALUES (12, 1, 3, 10, '시크릿 스캐닝 도구를 통한 자격증명 평문 저장 여부 점검(ex. Trufflehog, Gitleaks 등으로 외부/공개 저장소 속 자격증명 평문 저장 점검)', true, '2025-10-20 17:34:50.80202', '2025-10-20 17:34:50.80202', 2);
INSERT INTO public.checklists VALUES (13, 1, 3, 11, '액세스 키가 생성된 후 90일 이내', true, '2025-10-20 17:35:04.1744', '2025-10-20 17:35:04.1744', 2);
INSERT INTO public.checklists VALUES (14, 1, 3, 11, '민감 정보의 자동 교체 로직이 존재(ex. Secrets Manager의 보안 암호 자동 교체 구성 활성화)', true, '2025-10-20 17:35:29.023074', '2025-10-20 17:35:29.023074', 2);
INSERT INTO public.checklists VALUES (15, 1, 3, 12, '루트 계정의 Active 액세스 키 비활성화', true, '2025-10-20 17:35:29.023074', '2025-10-20 17:35:29.023074', 2);
INSERT INTO public.checklists VALUES (16, 1, 3, 12, '루트를 포함한 모든 사용자 계정의 MFA 활성화', true, '2025-10-20 17:35:42.774143', '2025-10-20 17:35:42.774143', 2);
INSERT INTO public.checklists VALUES (17, 1, 3, 13, '신뢰 정책에 사용할 계정/역할/서비스의 ARN으로 Principal 제한 및 Condition 활용', true, '2025-10-20 17:35:55.689718', '2025-10-20 17:35:55.689718', 2);
INSERT INTO public.checklists VALUES (18, 1, 3, 14, 'iam:PassRole 권한 사용 시, Resource를 특정 ARN으로 제한', true, '2025-10-20 17:36:12.298365', '2025-10-20 17:36:12.298365', 2);
INSERT INTO public.checklists VALUES (19, 1, 3, 15, 'IdP 연동 시, AssumeRole 정책 속 Principal은 특정 IdP의 ARN으로, Condition은 허용되는 IdP속성 값으로 제한', true, '2025-10-20 17:43:54.632385', '2025-10-20 17:43:54.632385', 2);
INSERT INTO public.checklists VALUES (20, 1, 3, 16, 'Cross-Account용 IAM 역할의 AssumeRole 정책 속 Principal은 특정 Provider/역할의 ARN으로,  Condition은 sts:ExternalId로 제한', true, '2025-10-20 17:44:45.180494', '2025-10-20 17:44:45.180494', 2);
INSERT INTO public.checklists VALUES (21, 1, 3, 17, '퇴직자 계정 권한 철회(ex. 콘솔 로그인 프로필, 액세스 키, 연결된 권한 정책, MFA, 인증서, 서비스 자격증명을 모두 삭제/해제)', true, '2025-10-20 17:45:08.127564', '2025-10-20 17:45:08.127564', 2);
INSERT INTO public.checklists VALUES (22, 1, 3, 17, '퇴직자 계정 활동 모니터링 및 로그 관리 운영체계 수립(ex. ConsoleLogin, CreateAccessKey 등의 잔여된 의심 활동을 탐지하기 위한 CloudTrail 쿼리 작성)', true, '2025-10-20 17:45:18.105372', '2025-10-20 17:45:18.105372', 2);
INSERT INTO public.checklists VALUES (23, 1, 4, 20, '외부 노출이 강력히 제한되어야 하는 내부 네트워크 운영 시, 배스천 호스트 구축', true, '2025-10-20 17:46:58.209166', '2025-10-20 17:46:58.209166', 2);
INSERT INTO public.checklists VALUES (24, 1, 5, 21, 'Lambda 함수 실행 시, 환경 변수를 KMS의 고객 마스터 키로 사용', true, '2025-10-20 17:47:48.584573', '2025-10-20 17:47:48.584573', 2);
INSERT INTO public.checklists VALUES (25, 1, 5, 22, 'Lambda 함수에 결함이 존재하는 코드 스캔(ex. Inspector 연동 및 사용 후 결과에서 심각도 HIGH, CRITICAL 미포함)', true, '2025-10-20 17:48:01.942166', '2025-10-20 17:48:01.942166', 2);
INSERT INTO public.checklists VALUES (26, 1, 6, 23, 'RDS의 DB 스냅샷 가시성이 프라이빗으로 설정', true, '2025-10-20 17:48:20.167131', '2025-10-20 17:48:20.167131', 2);
INSERT INTO public.checklists VALUES (27, 1, 6, 24, 'RDS의 퍼블릭 액세스 항목이 아니오로 설정', true, '2025-10-20 17:49:53.545763', '2025-10-20 17:49:53.545763', 2);
INSERT INTO public.checklists VALUES (28, 1, 6, 24, 'RDS의 DB 서브넷 그룹에 포함된 모든 서브넷을 프라이빗으로 설정', true, '2025-10-20 17:50:02.722438', '2025-10-20 17:50:02.722438', 2);
INSERT INTO public.checklists VALUES (29, 1, 7, 25, 'CloudTrail 추적에서 Organization 계층을 포함한 추적 로깅 활성화', true, '2025-10-20 17:50:17.797343', '2025-10-20 17:50:17.797343', 2);
INSERT INTO public.checklists VALUES (30, 1, 7, 26, 'CloudTrail 추적의 API 활동(읽기/쓰기) 모두 활성화', true, '2025-10-20 17:50:26.315542', '2025-10-20 17:50:26.315542', 2);
INSERT INTO public.checklists VALUES (31, 1, 7, 26, '비정상적인 API 호출 모니터링 및 로그 관리 운영체계 수립(ex. 대량 호출 RunInstances를 탐지 가능한 CloudTrail 쿼리 작성)', true, '2025-10-20 17:50:35.841097', '2025-10-20 17:50:35.841097', 2);
INSERT INTO public.checklists VALUES (32, 1, 8, 27, 'EKS 서비스 계정에 연결된 IAM 역할 정책 속 Action은 필요 권한으로, Resource는 특정 ARN으로 제한', true, '2025-10-20 17:50:47.41417', '2025-10-20 17:50:47.41417', 2);
INSERT INTO public.checklists VALUES (33, 1, 8, 27, 'EKS 사용 시, 쿠버네티스의 서비스 계정별로 IAM 역할 할당', true, '2025-10-20 17:50:58.900154', '2025-10-20 17:50:58.900154', 2);
INSERT INTO public.checklists VALUES (34, 1, 9, 28, 'KMS에서 외부 고객 관리형 키 Import 시, 만료 기간 설정', true, '2025-10-20 17:51:11.791358', '2025-10-20 17:51:11.791358', 2);
INSERT INTO public.checklists VALUES (35, 1, 9, 28, 'KMS에서 외부 고객 관리형 키 Reimport/삭제 시, 키 정책 속 Action은 특정 권한으로 제한되어 있고, Resource는 해당 고객 관리형 키의 ARN으로 제한하고, MFA를 강제', true, '2025-10-20 18:05:03.363129', '2025-10-20 18:05:03.363129', 2);
INSERT INTO public.checklists VALUES (36, 1, 9, 28, 'KMS에서 외부 고객 관리형 키의 키 정책 속 Principal의 KMS 관련 고위험 권한(ex. kms:ImportKeyMaterial, kms:decrypt)을 특정 고객 관리형 키의 역할 ARN으로 제한', true, '2025-10-20 18:05:16.57893', '2025-10-20 18:05:16.57893', 2);
INSERT INTO public.checklists VALUES (37, 1, 10, 29, 'SNS 주제 액세스 정책에서 sns:Publish, sns:Subscribe을 포함한 SNS 관련 권한이 Principal은 특정 ARN으로, Resource는 해당 주제의 ARN으로 제한', true, '2025-10-20 18:05:29.727617', '2025-10-20 18:05:29.727617', 2);
INSERT INTO public.checklists VALUES (38, 1, 11, 30, 'SQS 큐 정책 속 Principal이 특정 계정/역할/서비스의 ARN으로 제한', true, '2025-10-20 18:06:07.540679', '2025-10-20 18:06:07.540679', 2);
INSERT INTO public.checklists VALUES (39, 1, 12, 31, 'Route 53 레코드에 실제 소유/운영 중인 리소스만 존재', true, '2025-10-20 18:06:21.016038', '2025-10-20 18:06:21.016038', 2);
INSERT INTO public.checklists VALUES (40, 1, 13, 32, 'Organizations의 신뢰할 수 있는 액세스가 업무상 필요한 서비스에만 활성화', true, '2025-10-20 18:06:37.598267', '2025-10-20 18:06:37.598267', 2);
INSERT INTO public.checklists VALUES (41, 1, 13, 33, 'Organizations SCP 정책 속 불필요한 API(ex. ModifyReservedInstances, aws-marketplace:Subscribe)에 대해 Deny로 설정', true, '2025-10-20 18:06:53.127927', '2025-10-20 18:06:53.127927', 2);
INSERT INTO public.checklists VALUES (42, 1, 14, 34, 'ECR 리포지토리 정책 속 Principal을 리소스에 접근할 역할 ARN으로 제한', true, '2025-10-20 18:07:06.314398', '2025-10-20 18:07:06.314398', 2);
INSERT INTO public.checklists VALUES (43, 1, 14, 34, 'ECR의 이미지 스캔과 태그 불변성 활성화', true, '2025-10-20 18:07:17.472011', '2025-10-20 18:07:17.472011', 2);
INSERT INTO public.checklists VALUES (44, 1, 15, 37, 'ssm:SendCommand 권한 사용 시, 실행 대상의 리소스 ARN으로 제한', true, '2025-10-20 18:07:49.119131', '2025-10-20 18:07:49.119131', 2);
INSERT INTO public.checklists VALUES (45, 1, 15, 36, 'SSM 문서를 프라이빗으로 설정', true, '2025-10-20 18:08:00.579666', '2025-10-20 18:08:00.579666', 2);
INSERT INTO public.checklists VALUES (46, 1, 16, 37, 'GuardDuty에서 모든 멤버 계정과 모든 사용 리전에 일괄 활성화 적용 및 신규 계정 자동 가입 설정', true, '2025-10-20 18:08:18.290237', '2025-10-20 18:08:18.290237', 2);
INSERT INTO public.checklists VALUES (47, 1, 17, 38, 'Cognito Identity Pool에 연결된 IAM 역할 정책 속 Action은 필요 권한으로, Resource는 해당 역할이 접근 가능한 리소스의 ARN으로, Condition은 비인증(Unauthenticated) 역할에 대한 민감 리소스 접근 권한을 제한', true, '2025-10-20 18:08:31.109564', '2025-10-20 18:08:31.109564', 2);
INSERT INTO public.checklists VALUES (48, 1, 17, 39, 'Cognito를 통한 사용자 관리 시, 내부 서비스거나 관리자 계정만 발급해야 하는 경우 Self Sign Up 비활성화', true, '2025-10-20 18:08:41.614825', '2025-10-20 18:08:41.614825', 2);
INSERT INTO public.checklists VALUES (49, 1, 17, 40, 'Cognito에서 토큰 만료 시간을 애플리케이션 운영에 필요한 최소 시간으로 설정(ex. 액세스/ID 토큰은 15분~60분, 갱신 토큰은 7일~30일, 기준은 조직 정책에 따라 정의)', true, '2025-10-20 18:08:53.425148', '2025-10-20 18:08:53.425148', 2);
INSERT INTO public.checklists VALUES (50, 1, 18, 41, 'CloudFormation을 위한 IAM 역할 정책 속 두개의 권한(CloudFormation:CreateStack, iam:PassRole)을 동시 부여 제한', true, '2025-10-20 18:14:16.366175', '2025-10-20 18:14:16.366175', 2);
INSERT INTO public.checklists VALUES (51, 1, 19, 42, 'OpenSearch 도메인의 네트워크가 VPC 액세스 전용으로 설정', true, '2025-10-20 18:14:29.904989', '2025-10-20 18:14:29.904989', 2);
INSERT INTO public.checklists VALUES (52, 1, 19, 42, 'OpenSearch 도메인의 액세스 정책이 IP 또는 특정 IAM 역할/사용자로 제한', true, '2025-10-20 18:14:38.98094', '2025-10-20 18:14:38.98094', 2);
INSERT INTO public.checklists VALUES (53, 1, 20, 43, 'Elastic Beanstalk 환경 속성 속 소스가 Secrets Manager 혹은 SSM Parameter Store로 지정', true, '2025-10-20 18:14:48.89713', '2025-10-20 18:14:48.89713', 2);
INSERT INTO public.checklists VALUES (54, 1, 21, 44, 'Redshift 클러스터 암호화', true, '2025-10-20 18:15:00.48116', '2025-10-20 18:15:00.48116', 2);
INSERT INTO public.checklists VALUES (55, 1, 22, 45, 'Glue를 위한 IAM 역할 정책 속 두개의 권한(glue:CreateDevEndpoint, iam:PassRole)의 동시 부여 제한', true, '2025-10-20 18:15:10.810037', '2025-10-20 18:15:10.810037', 2);
INSERT INTO public.checklists VALUES (56, 1, 23, 46, '조직 내 Service Catalog 포트폴리오 공유가 필요한 경우, 조직 전체에 AcceptPortfolioShare 차단하는 SCP 정책 작성 및 조직 구조 내의 공유 방법 선택', true, '2025-10-20 18:15:21.608689', '2025-10-20 18:15:21.608689', 2);
INSERT INTO public.checklists VALUES (57, 1, 23, 46, 'Service Catalog 제약 조건 생성 시 할당하는 IAM 역할에 Principal은 Service Catalog 서비스 지정, Action은 고위험 권한(ex. iam:CreatePolicy, iam:AttachRolePolicy) Deny, Condition은 호출 출처 제한', true, '2025-10-20 18:15:38.330577', '2025-10-20 18:15:38.330577', 2);
INSERT INTO public.checklists VALUES (58, 1, 24, 47, 'DocumentDB 스냅샷의 공유 속성이 프라이빗 설정', true, '2025-10-20 18:15:47.064494', '2025-10-20 18:15:47.064494', 2);
INSERT INTO public.checklists VALUES (59, 1, 24, 47, 'DocumentDB 스냅샷 생성할 클러스터의 KMS 암호화', true, '2025-10-20 18:15:56.027834', '2025-10-20 18:15:56.027834', 2);
INSERT INTO public.checklists VALUES (60, 1, 25, 48, 'Bedrock 모델 활성화/호출 계열 권한(ex. bedrock:InvokeModel)을 특정 모델 ARN으로, Condition을 호출 리전/주체로 제한', true, '2025-10-20 18:16:07.552612', '2025-10-20 18:16:07.552612', 2);
INSERT INTO public.checklists VALUES (61, 1, 26, 49, 'SES 고위험 권한(ex. SendEmail, PutAccountDetails)을 승인된 관리자 또는 서비스 전용 IAM 역할에만 허용', true, '2025-10-20 18:16:20.276733', '2025-10-20 18:16:20.276733', 2);
INSERT INTO public.checklists VALUES (62, 1, 26, 49, 'SES를 위한 IAM 역할 정책 속 Resource를 구체적인 ARN, 도메인, 아이덴티티로 제한', true, '2025-10-20 18:16:28.95513', '2025-10-20 18:16:28.95513', 2);
INSERT INTO public.checklists VALUES (63, 1, 27, 50, 'AppStream의 Fleet/이미지 빌더에 연결된 IAM 역할 정책 속 Resource를 특정 IAM 역할의 ARN으로 제한', true, '2025-10-20 18:16:38.139084', '2025-10-20 18:16:38.139084', 2);


--
-- Data for Name: flyway_schema_history; Type: TABLE DATA; Schema: public; Owner: -
--

INSERT INTO public.flyway_schema_history VALUES (1, '1', 'Create initial tables', 'SQL', 'V1__Create_initial_tables.sql', 1106060758, 'clouddoctor', '2025-10-19 20:14:48.92352', 94, true);


--
-- Data for Name: guideline_links; Type: TABLE DATA; Schema: public; Owner: -
--

INSERT INTO public.guideline_links VALUES (9, 2, 'https://hackingthe.cloud/aws/exploitation/local_ec2_priv_esc_through_user_data/', 'Hacking The Cloud(2024, 01) - User Data를 통한 EC2 권한 상승', NULL, '2025-10-19 21:35:48.801026');
INSERT INTO public.guideline_links VALUES (10, 2, 'https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-metadata.html', 'AWS User Guide - User Data 보안: 민감 정보 저장의 위험과 안전한 관리 방안', NULL, '2025-10-19 21:35:48.805276');
INSERT INTO public.guideline_links VALUES (11, 2, 'https://rodelllemit.medium.com/aws-pentesting-ec2-user-data-761f5cd5ee89', 'Meduim(2024,11) - User Data 변경을 통한 EC2 인스턴스 내 권한 에스컬레이션', NULL, '2025-10-19 21:35:48.811498');
INSERT INTO public.guideline_links VALUES (12, 1, 'https://securityboulevard.com/2020/06/the-capital-one-data-breach-a-year-later-a-look-at-what-went-wrong-and-practical-guidance-to-avoid-a-breach-of-your-own/', 'Capital One(2019, 04) - 캐피털 원 데이터 유출 사례로 본 IMDSv2 전환 및 최소 권한(Least Privilege) 원칙 적용의 필요성', NULL, '2025-10-19 21:36:06.130424');
INSERT INTO public.guideline_links VALUES (13, 1, 'https://engineering.prezi.com/prezi-got-pwned-a-tale-of-responsible-disclosure-ccdc71bb6dd1', 'Prezi(2014, 10) - Prezi SSRF로 인한 침해사고', NULL, '2025-10-19 21:36:06.136974');
INSERT INTO public.guideline_links VALUES (14, 1, 'https://www.sysdig.com/blog/cloud-breach-terraform-data-theft', 'sysdig(2023, 02) - IMDSv1 및 과도한 IAM 권한이 데이터 절도에 미치는 영향', NULL, '2025-10-19 21:36:06.140554');
INSERT INTO public.guideline_links VALUES (15, 1, 'https://blog.qualys.com/vulnerabilities-threat-research/2024/09/12/totalcloud-insights-unmasking-aws-instance-metadata-service-v1-imdsv1-the-hidden-flaw-in-aws-security', 'qualys(2025, 06) - IMDSv1 취약점 분석 및 IMDSv2 전환의 중요성', NULL, '2025-10-19 21:36:06.144852');
INSERT INTO public.guideline_links VALUES (16, 3, 'https://blog.lethalbit.com/hunting-for-sensitive-data-in-public-amazon-images-ami/', 'Lethal Bit(2023, 07) - 공개된 아마존 이미지(AMI)에서 민감 데이터 찾는 법', NULL, '2025-10-19 21:37:23.529295');
INSERT INTO public.guideline_links VALUES (17, 3, 'https://seclab.nu/static/publications/sac2012ec2.pdf', 'Seoul National University Security Lab(2012) - Public AMI 위험성 관련 연구', NULL, '2025-10-19 21:37:23.535504');
INSERT INTO public.guideline_links VALUES (18, 3, 'https://securitycafe.ro/2024/05/08/aws-cloudquarry-digging-for-secrets-in-public-amis', 'securitycafe(2024, 05) - 공개 AMI 내부에 저장된 500GB 이상의 자격증명 추출', NULL, '2025-10-19 21:37:23.543644');
INSERT INTO public.guideline_links VALUES (19, 3, 'https://www.bankinfosecurity.com/exposed-amis-hidden-risk-in-aws-environments-a-26017', 'bankinfosecurity(2024, 08) - 공개 AMI를 이용한 API 키 탈취 및 금융 자산 위협 사례', NULL, '2025-10-19 21:37:23.554761');
INSERT INTO public.guideline_links VALUES (20, 4, 'https://securitylabs.datadoghq.com/articles/whoami-a-cloud-image-name-confusion-attack/', 'Datadog(2025, 02) - AWS AMI 이름 혼동 공격: 소유자 필드 누락으로 인한 원격 코드 실행 취약점', NULL, '2025-10-19 21:38:40.398383');
INSERT INTO public.guideline_links VALUES (21, 4, 'https://web.archive.org/web/20210625192906/https://www.darkreading.com/cloud/cryptominer-found-embedded-in-aws-community-ami/d/d-id/1338713/', 'Dark Reading(2020, 08) - AWS 커뮤니티 AMI에서 발견된 암호화폐 채굴 악성코드', NULL, '2025-10-19 21:38:40.403591');
INSERT INTO public.guideline_links VALUES (22, 4, 'https://web.archive.org/web/20210625192906/https://www.darkreading.com/cloud/cryptominer-found-embedded-in-aws-community-ami/d/d-id/1338713/', 'CSO(2025, 02) - AWS AMI 검색 시 소유자 지정 누락 위험성 및 ''Allowed AMIs'' 방어 대책', NULL, '2025-10-19 21:38:40.410413');
INSERT INTO public.guideline_links VALUES (23, 5, 'https://www.trendmicro.com/en_us/research/18/k/outlaw-group-distributes-botnet-for-cryptocurrency-mining-scanning-and-brute-force.html', 'Trend Micro(2018, 10) - Outlaw 그룹, 암호화폐 채굴, 스캐닝, 브루트포스를 위한 봇넷 배포', NULL, '2025-10-19 21:40:52.787158');
INSERT INTO public.guideline_links VALUES (24, 5, 'https://cloudsecurityalliance.org/blog/2023/02/06/exposed-remote-desktop-protocol-actively-targeted-by-threat-actors-to-deploy-ransomware', 'CSA(2023, 02) - 노출된 RDP를 통한 랜섬웨어 공격 확산 및 방어 대책', NULL, '2025-10-19 21:40:52.791855');
INSERT INTO public.guideline_links VALUES (25, 5, 'https://www.paloaltonetworks.com/blog/2021/07/diagnosing-the-ransomware-deployment-protocol', 'paloalto(2021,07) - RDP 노출 증가와 랜섬웨어 공격 위협 증대 보고서', NULL, '2025-10-19 21:40:52.795358');
INSERT INTO public.guideline_links VALUES (26, 6, 'https://media.defcon.org/DEF%20CON%2027/DEF%20CON%2027%20presentations/DEFCON-27-Ben-Morris-More-Keys-Than-A-Piano-Finding-Secrets-In-Publicly-Exposed-Ebs-Volumes.pdf', 'DEF CON 27(2019, 08) - AWS 공개 EBS 볼륨 내 민감 정보(Secrets) 노출 위험 분석', NULL, '2025-10-19 21:41:38.571114');
INSERT INTO public.guideline_links VALUES (27, 6, 'https://stratus-red-team.cloud/attack-techniques/AWS/aws.exfiltration.ec2-share-ebs-snapshot/', 'Stratus Red Team() - AWS EBS 스냅샷 공유 기능을 악용한 데이터 유출(Exfiltration) 기법', NULL, '2025-10-19 21:41:38.576759');
INSERT INTO public.guideline_links VALUES (28, 6, 'https://techcrunch.com/2019/08/09/aws-ebs-cloud-backups-leak', 'TechCrunch(2019, 08) - 수백 건의 AWS EBS 스냅샷 노출로 인한 민감 데이터 유출 위험', NULL, '2025-10-19 21:41:38.582018');
INSERT INTO public.guideline_links VALUES (29, 7, 'https://medium.com/@red.whisperer/from-s3-bucket-to-internal-network-operation-8073954932b4', 'Medium(2024, 03) - S3의 퍼블릭 설정으로 악성코드 업로드', NULL, '2025-10-19 21:42:59.89978');
INSERT INTO public.guideline_links VALUES (30, 7, 'https://web.archive.org/web/20210413201832/https://www.tripwire.com/state-of-security/security-data-protection/la-times-website-cryptojacking-attack/', 'LA Times(2018, 02) - S3 퍼블릭 설정으로 크립토마이닝 JS코드 주입', NULL, '2025-10-19 21:42:59.90646');
INSERT INTO public.guideline_links VALUES (31, 7, 'https://www.upguard.com/breaches/cloud-leak-accenture', 'UpGuard(2017, 10) - AWS S3 버킷을 통한 기업 비밀(API 키, 인증 정보) 유출', NULL, '2025-10-19 21:42:59.917708');
INSERT INTO public.guideline_links VALUES (33, 8, 'https://hackingthe.cloud/aws/post_exploitation/s3_acl_persistence/', 'Hacking The Cloud(2021, 04) - S3 파일 ACL 지속성', NULL, '2025-10-19 21:44:15.245976');
INSERT INTO public.guideline_links VALUES (34, 8, 'https://hackerone.com/reports/128088', 'hackerone(2016, 04) - S3 ACL 공개 쓰기 설정', NULL, '2025-10-19 21:44:15.253934');
INSERT INTO public.guideline_links VALUES (146, 48, 'https://www.wiz.io/blog/jinx-2401-llm-hijacking-aws', 'Wiz(2024, 12) - Bedrock InvokeModel을 이용한 LLM 하이재킹', NULL, '2025-10-20 16:47:34.283226');
INSERT INTO public.guideline_links VALUES (147, 48, 'https://www.csoonline.com/article/3535433/llmjacking-how-attackers-use-stolen-aws-credentials-to-enable-llms-and-rack-up-costs-for-victims.html', 'CSO(2024, 09) - AWS 환경 내 LLMjacking 공격 사례 연구 및 AI 서비스 보안 대책', NULL, '2025-10-20 16:47:34.287451');
INSERT INTO public.guideline_links VALUES (148, 48, 'https://aws.amazon.com/ko/blogs/security/implementing-least-privilege-access-for-amazon-bedrock', 'AWS Security Blog(2025, 02) - Amazon Bedrock 애플리케이션에 대한 최소 권한 원칙', NULL, '2025-10-20 16:47:34.290923');
INSERT INTO public.guideline_links VALUES (149, 48, 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Bedrock/service-role-policy-too-permissive.html', 'TrendMicro - Amazon Bedrock 서비스 역할의 과도한 권한 위험 및 최소 권한 적용 방안', NULL, '2025-10-20 16:47:34.294213');
INSERT INTO public.guideline_links VALUES (150, 49, 'https://www.wiz.io/blog/wiz-discovers-cloud-email-abuse-campaign', 'Wiz(2025, 09) - 유출된 AWS 키를 이용한 클라우드 이메일 서비스(SES) 탈취 및 피싱 캠페인', NULL, '2025-10-20 16:48:22.254837');
INSERT INTO public.guideline_links VALUES (151, 49, 'https://cyberpress.org/amazon-ses-phishing', 'cyberpress(2025, 09) - Amazon SES 피싱 공격 분석: 도난 자격증명과 다중 리전 PutAccountDetails 악용을 통한 샌드박스 우회', NULL, '2025-10-20 16:48:22.258975');
INSERT INTO public.guideline_links VALUES (152, 50, 'https://www.youtube.com/watch?v=Stf5pf3ERCY', 'DEF CON30(2022, 08) - Appstream 권한 상승의 위험성', NULL, '2025-10-20 16:49:00.088175');
INSERT INTO public.guideline_links VALUES (32, 7, 'https://www.techtarget.com/searchsecurity/news/450422709/Misconfigured-AWS-S3-bucket-exposes-millions-of-Verizon-customers-data', 'TechTarget(2017, 07) - AWS S3 버킷 설정 오류로 인한 Verizon 고객 데이터(1,400만 건) 유출 사고', NULL, '2025-10-19 21:42:59.923656');
INSERT INTO public.guideline_links VALUES (35, 9, 'https://bleemb.medium.com/data-exfiltration-with-native-aws-s3-features-c94ae4d13436', 'Medium(2023, 01) - S3 네이티브 기능을 악용한 데이터 유출', NULL, '2025-10-19 21:45:05.39499');
INSERT INTO public.guideline_links VALUES (36, 9, 'https://hackingthe.cloud/aws/exploitation/s3-bucket-replication-exfiltration/', 'Hacking The Cloud(2023, 01) - 버킷 복제 정책으로 S3 데이터 유출', NULL, '2025-10-19 21:45:05.399072');
INSERT INTO public.guideline_links VALUES (37, 9, 'https://www.vectra.ai/blog/abusing-the-replicator-silently-exfiltrating-data-with-the-aws-s3-replication-service', 'VECTRA(2022, 07) - AWS S3 복제 서비스 오용을 통한 은밀한 데이터 유출 공격 분석', NULL, '2025-10-19 21:45:05.401518');
INSERT INTO public.guideline_links VALUES (41, 10, 'https://redhuntlabs.com/blog/scanning-millions-of-publicly-exposed-docker-containers-thousands-of-secrets-leaked/', 'RedHunt Labs(2021, 11) - 도커 허브 상의 이미지 내 AWS 민감 정보 유출', NULL, '2025-10-19 21:48:03.448687');
INSERT INTO public.guideline_links VALUES (42, 10, 'https://blog.emberjs.com/security-incident-aws-s3-key-exposure/', 'Credentials leaked in npm package(2016, 12) - 웹 소스코드 내 S3 Access Key 유출', NULL, '2025-10-19 21:48:03.454585');
INSERT INTO public.guideline_links VALUES (43, 10, 'https://www.bleepingcomputer.com/news/security/thousands-of-images-on-docker-hub-leak-auth-secrets-private-keys', 'BleepingComputer(2023, 07) - 개발자 부주의로 인한 Docker 이미지 내 민감 정보 유출', NULL, '2025-10-19 21:48:03.459634');
INSERT INTO public.guideline_links VALUES (44, 10, 'https://www.thestack.technology/infosys-leak-aws-key-exposed-on-pypi', 'THE STACK(2022, 11) - PyPI에 최고 관리자(God Mode) AWS S3 키 노출', NULL, '2025-10-19 21:48:03.464049');
INSERT INTO public.guideline_links VALUES (45, 11, 'https://web.archive.org/web/20210127001214/https://threatpost.com/data-from-august-breach-of-amazon-partner-juspay-dumped-online/162740/', 'Juspay (2021, 01) - 마스킹된 카드 데이터, 이메일 ID 및 전화번호 유출', NULL, '2025-10-19 21:48:51.618788');
INSERT INTO public.guideline_links VALUES (46, 11, 'https://www.invictus-ir.com/news/ransomware-in-the-cloud', 'Invictus(2024, 01) - 장기 자격증명 유출로 인한 랜섬웨어', NULL, '2025-10-19 21:48:51.622006');
INSERT INTO public.guideline_links VALUES (47, 11, 'https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much', 'securitylabs(2025, 05) - AWS 장기 액세스 키 오용 및 신종 지속성 기법 식별', NULL, '2025-10-19 21:48:51.625646');
INSERT INTO public.guideline_links VALUES (48, 12, 'https://www.breaches.cloud/incidents/chegg/', 'Chegg(2018, 04) - 루트 자격증명 관리 실패', NULL, '2025-10-19 21:50:12.563339');
INSERT INTO public.guideline_links VALUES (49, 12, 'https://web.archive.org/web/20210128055101/https://expel.io/blog/behind-the-scenes-expel-soc-alert-aws/', 'Expel (2020,07) - Root access key 유출로 인한 크립토마이닝', NULL, '2025-10-19 21:50:12.567702');
INSERT INTO public.guideline_links VALUES (50, 12, 'https://medium.com/%40kariarce2377/my-horror-story-discovering-that-my-aws-root-account-was-hacked-2cf3ce41bc47', 'Medium(2025,09) - AWS 루트 계정 침해 사례 및 보안 모범 사례의 중요성', NULL, '2025-10-19 21:50:12.57118');
INSERT INTO public.guideline_links VALUES (51, 13, 'https://hackingthe.cloud/aws/exploitation/Misconfigured_Resource-Based_Policies/misconfigured_iam_role_trust_policy_wildcard_principal/', 'Hacking The Cloud(2024, 01) - 와일드카드를 남용한 잘못된 신뢰 정책', NULL, '2025-10-19 21:50:59.800468');
INSERT INTO public.guideline_links VALUES (52, 13, 'https://www.netspi.com/blog/technical-blog/cloud-penetration-testing/pivoting-clouds-aws-organizations-part-1/', 'NetSPI(2023, 03) - 계정 생성, 신뢰할 수 있는 액세스 및 위임된 관리', NULL, '2025-10-19 21:50:59.803721');
INSERT INTO public.guideline_links VALUES (53, 14, 'https://www.praetorian.com/blog/privilege-escalation-in-aws-with-passrole-attacks/', 'Praetorian(2018, 10) - iam:PassRole 악용을 통한 AWS 권한 상승 및 네트워크 우회 공격 사례', NULL, '2025-10-19 21:51:54.341929');
INSERT INTO public.guideline_links VALUES (54, 14, 'https://www.tenable.com/blog/auditing-iampassrole-a-problematic-privilege-escalation-permission', 'tenable(2021, 01) - AWS iam:PassRole 권한 오용 위험 및 최소 권한 감사 방안', NULL, '2025-10-19 21:51:54.346224');
INSERT INTO public.guideline_links VALUES (55, 14, 'https://aws.amazon.com/ko/blogs/security/how-to-use-the-passrole-permission-with-iam-roles/', 'AWS Security Blog(2023, 11) - AWS IAM 역할과 iam:PassRole 권한 사용 방법 및 보안 모범 사례', NULL, '2025-10-19 21:51:54.352846');
INSERT INTO public.guideline_links VALUES (56, 15, 'https://www.crowdstrike.com/en-us/blog/how-adversaries-persist-with-aws-user-federation/', 'crowdstrike (2023, 01) - 잘못된 Federation 방식 사용 사례', NULL, '2025-10-19 21:52:56.799686');
INSERT INTO public.guideline_links VALUES (57, 15, 'https://expel.com/wp-content/uploads/2025/01/Expel-Annual-Threat-Report-2025-013025.pdf', 'Expel (2025, 01) - Okta SSO 사용으로 인한 AWS 침해', NULL, '2025-10-19 21:52:56.802041');
INSERT INTO public.guideline_links VALUES (58, 16, 'https://www.slideshare.net/slideshow/saaspocalypse-the-complexity-and-power-of-aws-cross-account-access/237678222', 'SaaSpocalypse(2020, 08) - AWS Cross-Account 접근의 위험 분석 및 External ID 기반 보안 강화 전략', NULL, '2025-10-19 21:53:41.564888');
INSERT INTO public.guideline_links VALUES (59, 16, 'https://www.praetorian.com/blog/aws-iam-assume-role-vulnerabilities', 'praetorian(2020, 06) - 잘못된 ExternalId 구현이 AWS 고객 계정 권한 상승을 초래', NULL, '2025-10-19 21:53:41.570006');
INSERT INTO public.guideline_links VALUES (60, 17, 'https://www.breaches.cloud/incidents/first-republic/', 'irst Republic Bank(2020, 02) - 해고된 직원에 의한 데이터 유출', NULL, '2025-10-19 22:21:29.572568');
INSERT INTO public.guideline_links VALUES (61, 17, 'https://rubycentral.org/news/rubygems-org-aws-root-access-event-september-2025/', 'Rubygems.org (2025, 09) - 전임 관리자 계정 권한 미회수로 AWS 루트 접근 유출 및 보안 비상사태 발생', NULL, '2025-10-19 22:21:29.575238');
INSERT INTO public.guideline_links VALUES (62, 18, 'https://www.breaches.cloud/incidents/first-republic/', 'irst Republic Bank(2020, 02) - 해고된 직원에 의한 데이터 유출', NULL, '2025-10-19 22:22:12.496963');
INSERT INTO public.guideline_links VALUES (63, 18, 'https://rubycentral.org/news/rubygems-org-aws-root-access-event-september-2025/', 'Rubygems.org (2025, 09) - 전임 관리자 계정 권한 미회수로 AWS 루트 접근 유출 및 보안 비상사태 발생', NULL, '2025-10-19 22:22:12.500196');
INSERT INTO public.guideline_links VALUES (67, 19, 'https://frichetten.com/blog/abusing-aws-connection-tracking/', 'frichetten(2020, 08) - AWS 연결 추적 남용', NULL, '2025-10-20 14:29:21.219218');
INSERT INTO public.guideline_links VALUES (68, 19, 'https://www.boannews.com/media/view.asp?idx=101097', '보안뉴스(2021, 09) - 국내 4개 사업자 AWS 관리자 접근권한 제한 부재', NULL, '2025-10-20 14:29:21.225123');
INSERT INTO public.guideline_links VALUES (69, 19, 'https://cybersapiens.com.au/identifying-misconfigured-security-groups-unrestricted-traffic-and-public-facing-endpoints', 'yberSapiens(2025, 05) - 보안 그룹 오설정 진단: ''0.0.0.0/0'' 개방으로 인한 공용 접근', NULL, '2025-10-20 14:29:21.22886');
INSERT INTO public.guideline_links VALUES (73, 21, 'https://hackingthe.cloud/aws/exploitation/lambda-steal-iam-credentials/', 'Hacking The Cloud(2020, 08) - AWS Lambda 환경 변수/런타임 API 악용을 통한 IAM 자격증명 탈취', NULL, '2025-10-20 14:32:48.594985');
INSERT INTO public.guideline_links VALUES (74, 21, 'https://unit42.paloaltonetworks.com/compromised-cloud-compute-credentials', 'UNIT 42(2022, 12) - AWS Lambda 환경변수 악용을 통한 공격', NULL, '2025-10-20 14:32:48.598781');
INSERT INTO public.guideline_links VALUES (75, 22, 'https://github.com/RhinoSecurityLabs/cloudgoat/tree/master/cloudgoat/scenarios/aws/vulnerable_lambda', 'CloudGoat - 취약한 lambda를 이용한 AWS 계정 권한 상승', NULL, '2025-10-20 16:20:01.879554');
INSERT INTO public.guideline_links VALUES (76, 22, 'https://rhinosecuritylabs.com/cloud-security/cloudgoat-vulnerable-lambda-functions/', 'RHINO SECURITY LABS - 취약한 AWS Lambda 함수(SQL Injection)를 이용한 권한 상승 경로', NULL, '2025-10-20 16:20:01.884011');
INSERT INTO public.guideline_links VALUES (77, 22, 'https://docs.aws.amazon.com/inspector/latest/user/scanning_resources_lambda_code.html', 'aws User Guide - Inspector Lambda 코드 스캐닝', NULL, '2025-10-20 16:20:01.886947');
INSERT INTO public.guideline_links VALUES (78, 23, 'https://www.mitiga.io/blog/how-mitiga-found-pii-in-exposed-amazon-rds-snapshots', 'Mitiga(2020, 08) - RDS 스냅샷 공개 설정으로 인한 데이터 유출', NULL, '2025-10-20 16:21:47.642148');
INSERT INTO public.guideline_links VALUES (79, 23, 'https://www.clouddefense.ai/compliance-rules/cisa-cyber-essentials/systems/rds-db-snapshot-prohibit-public-access', 'CloudDefense.AI - RDS 스냅샷 공개 액세스 금지', NULL, '2025-10-20 16:21:47.64462');
INSERT INTO public.guideline_links VALUES (80, 23, 'https://gbhackers.com/amazon-rds-instances-leaking-user-data', 'gbhackers(2022, 11) - RDS 스냅샷의 부주의한 공개 공유로 인한 대규모 고객 데이터 유출', NULL, '2025-10-20 16:21:47.648639');
INSERT INTO public.guideline_links VALUES (81, 23, 'https://www.secureblink.com/cyber-security-news/millions-of-corporate-pi-is-leaked-from-vulnerable-amazon-rds-snapshots', 'SecureBlink(2022, 11) - 잘못 구성된 Amazon RDS 공개 스냅샷으로 인한 기업 PII 노출', NULL, '2025-10-20 16:21:47.651215');
INSERT INTO public.guideline_links VALUES (84, 25, 'https://expel.com/blog/finding-evil-in-aws/', 'expel(2020, 04) - CloudTrail 활성화를 통한 공격 징후 탐지 및 차단 사례', NULL, '2025-10-20 16:23:38.881878');
INSERT INTO public.guideline_links VALUES (85, 25, 'https://medium.com/starting-up-security/investigating-cloudtrail-logs-c2ecdf578911', 'Medium(2016, 11) - AWS 침해 사고 대응을 위한 CloudTrail 로그 분석', NULL, '2025-10-20 16:23:38.890987');
INSERT INTO public.guideline_links VALUES (86, 25, 'https://www.sysdig.com/blog/cloud-breach-terraform-data-theft', 'Sysdig(2023, 02) - SCARLETEEL 공격자가 AWS CloudTrail 로깅을 중단하고 데이터 절도 수행', NULL, '2025-10-20 16:23:38.896761');
INSERT INTO public.guideline_links VALUES (87, 26, 'https://expel.com/blog/incident-report-from-cli-to-console-chasing-an-attacker-in-aws/', 'expel(2022, 04) - 의심 API 조합을 통한 조기 탐지 및 대응 사례', NULL, '2025-10-20 16:24:33.008456');
INSERT INTO public.guideline_links VALUES (88, 26, 'https://www.sysdig.com/blog/cloud-threats-deploying-crypto-cdn', 'Sysdig(2024, 03) - AWS 클라우드 자원을 악용한 크립토 CDN 공격 분석', NULL, '2025-10-20 16:24:33.012186');
INSERT INTO public.guideline_links VALUES (89, 27, 'https://www.crn.com/news/cloud/2025/aws-eks-kubernetes-critical-security-flaw-exposes-credentials1', 'CRN(2025, 06) - AWS EKS Pod Identity 오설정으로 인한 클러스터 자격증명 노출 위험', NULL, '2025-10-20 16:26:10.903854');
INSERT INTO public.guideline_links VALUES (90, 27, 'https://www.slideshare.net/slideshow/exploit-k8s-via-misconfiguration-yaml-in-csp-environments/273379601#11', 'EF CON32(2024, 08) - Kubernetes RBAC 및 Pod Security Context 오설정을 통한 권한 확대 방안', NULL, '2025-10-20 16:26:10.91316');
INSERT INTO public.guideline_links VALUES (91, 27, 'https://aws.amazon.com/ko/blogs/security/how-to-detect-security-issues-in-amazon-eks-clusters-using-amazon-guardduty-part-1', 'AWS Security Blog(2022, 11) - Amazon EKS 오설정(Anonymous Access)이 랜섬웨어 공격으로 이어지는 5단계 분석', NULL, '2025-10-20 16:26:10.919285');
INSERT INTO public.guideline_links VALUES (92, 28, 'https://www.youtube.com/watch?v=8QdZ2-sAQFs', 'DEF CON 28(2020, 08) - KMS 정책 오설정을 악용한 랜섬웨어 공격', NULL, '2025-10-20 16:27:04.104686');
INSERT INTO public.guideline_links VALUES (93, 28, 'https://blog.pwnedlabs.io/ransomwhen-the-hidden-risks-of-aws-kms-in-ransomware-attacks?utm_source', 'PWNED LABS(2025, 03) - AWS KMS BYOKM 기능을 악용한 클라우드 랜섬웨어 공격 분석 및 탐지 전략', NULL, '2025-10-20 16:27:04.122577');
INSERT INTO public.guideline_links VALUES (94, 28, 'https://permiso.io/blog/ransomwhen-i-did-not-even-notice-it', 'Permiso(2025, 02) - KMS 키를 이용한 S3 버킷 데이터 암호화 랜섬웨어 공격', NULL, '2025-10-20 16:27:04.128847');
INSERT INTO public.guideline_links VALUES (95, 29, 'https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-aws-activity-to-phishing/', 'Datadog(2024, 03) - Datadog Threat Detection 팀의 SMS 발송 설정 열거 악성 활동', NULL, '2025-10-20 16:28:55.821855');
INSERT INTO public.guideline_links VALUES (96, 29, 'https://tutorgeeks.blogspot.com/2019/11/publicly-exposed-aws-sns-topics.html', 'Tutorgeeks(2019, 04) - 토픽 공개 노출 위협: 구독/발행 권한 오용으로 인한 데이터 유출 및 스팸 공격', NULL, '2025-10-20 16:28:55.82766');
INSERT INTO public.guideline_links VALUES (97, 30, 'https://rodelllemit.medium.com/aws-pentesting-abusing-overly-permissive-sqs-queue-156297205afe', 'Medium(2025, 01) - AWS SQS 큐 정책을 악용한 민감 정보 탈취 사례', NULL, '2025-10-20 16:29:46.812866');
INSERT INTO public.guideline_links VALUES (98, 30, 'https://www.plerion.com/blog/your-queues-your-responsibility', 'plerion(2024, 08) - AWS SQS 큐 공개 노출 위험: 잘못된 정책 설정으로 인한 메시지 주입 및 데이터 탈취', NULL, '2025-10-20 16:29:46.818126');
INSERT INTO public.guideline_links VALUES (99, 31, 'https://hackerone.com/reports/1179193', 'Hackerone(2021, 04) - 삭제된 EC2 인스턴스 미관리로 인한 서브도메인 탈취', NULL, '2025-10-20 16:30:42.235932');
INSERT INTO public.guideline_links VALUES (100, 31, 'https://hackingthe.cloud/aws/exploitation/orphaned_cloudfront_or_dns_takeover_via_s3/', 'Hacking The Cloud(2021, 03) - 삭제된 S3 미관리로 인한 서브도메인 탈취', NULL, '2025-10-20 16:30:42.239329');
INSERT INTO public.guideline_links VALUES (101, 31, 'https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/protection-from-dangling-dns.html', 'AWS Developer Guide - AWS Route 53 Dangling Delegation Records 방지 가이드', NULL, '2025-10-20 16:30:42.242756');
INSERT INTO public.guideline_links VALUES (102, 31, 'https://blogs.infoblox.com/threat-intelligence/cloudy-with-a-chance-of-hijacking-forgotten-dns-records-enable-scam-actor/', 'infoblox(2025, 05) - Dangling CNAME 기록을 통한 CDC 등 주요 기관 서브도메인 탈취', NULL, '2025-10-20 16:30:42.247269');
INSERT INTO public.guideline_links VALUES (103, 32, 'https://securitylabs.datadoghq.com/articles/tales-from-the-cloud-trenches-the-attacker-doth-persist-too-much/', 'Datadog Security Labs(2025, 05) - AWS 침투 후 공격자 지속성 확보 신규 전술 분석', NULL, '2025-10-20 16:31:35.51795');
INSERT INTO public.guideline_links VALUES (104, 32, 'https://hackingthe.cloud/aws/general-knowledge/aws_organizations_defaults/', 'Hacking The Cloud(2022, 11) - AWS Organizations 기본 설정의 보안 취약점과 피보팅 경로', NULL, '2025-10-20 16:31:35.522816');
INSERT INTO public.guideline_links VALUES (105, 32, 'https://www.netspi.com/blog/technical-blog/cloud-pentesting/pivoting-clouds-aws-organizations-part-1/', 'netspi(2023, 03) - AWS Organizations 권한 확장분석: 계정 생성 및 Trusted Access 취약점 활용', NULL, '2025-10-20 16:31:35.527717');
INSERT INTO public.guideline_links VALUES (106, 33, 'https://hackingthe.cloud/aws/general-knowledge/block-expensive-actions-with-scps/', 'Hacking The Cloud(2024, 07) -  AWS SCP를 활용한 고비용 API 호출 방지 전략', NULL, '2025-10-20 16:32:15.988849');
INSERT INTO public.guideline_links VALUES (107, 34, 'https://medium.com/ironsource-tech-blog/abusing-elastic-container-registry-ecr-to-own-aws-environments-47534ad61729', 'ironSource (2022,08) - ECR 권한 정책 오용으로 AWS 환경 장악', NULL, '2025-10-20 16:33:27.681483');
INSERT INTO public.guideline_links VALUES (108, 34, 'https://hackingthe.cloud/aws/exploitation/Misconfigured_Resource-Based_Policies/misconfigured_ecr_resource_policy/', 'Hacking The Cloud(2022, 11) - ECR 리소스 정책 오용 및 컨테이너 이미지 탈취/변조 공격', NULL, '2025-10-20 16:33:27.685867');
INSERT INTO public.guideline_links VALUES (109, 34, 'https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-1-ecr-repositories-not-public', 'prismacloud(2025, 06) - 공개 접근 허용 ECR 리포지토리 탐지 및 차단 정책', NULL, '2025-10-20 16:33:27.689405');
INSERT INTO public.guideline_links VALUES (110, 35, 'https://medium.com/%40adammesser_51095/cloud-digital-forensics-and-incident-response-aws-iam-privilege-escalation-leads-to-ec2-2d787a4e99a7', 'Medium(2024, 08) - AWS Systems Manager(SSM) Run Command 악용을 통한 시스템 수준 랜섬웨어 배포', NULL, '2025-10-20 16:34:35.73768');
INSERT INTO public.guideline_links VALUES (111, 35, 'https://hackingthe.cloud/aws/post_exploitation/run_shell_commands_on_ec2/', 'Hacking The Cloud(2022, 04) - AWS SSM을 이용한 EC2 셸 명령 실행 및 악용 방안', NULL, '2025-10-20 16:34:35.74353');
INSERT INTO public.guideline_links VALUES (112, 35, 'https://www.elastic.co/guide/en/security/8.19/aws-ssm-sendcommand-with-run-shell-command-parameters.html', 'elastic - SSM SendCommand를 통한 악성 쉘 명령 실행 탐지 및 분석', NULL, '2025-10-20 16:34:35.748579');
INSERT INTO public.guideline_links VALUES (113, 35, 'https://securitycafe.ro/2023/01/17/aws-post-explitation-with-ssm-sendcommand', 'securitycafe(2023, 01) - AWS SSM SendCommand 오용: 네트워크 독립적 루트 권한 원격 코드 실행(RCE) 공격', NULL, '2025-10-20 16:34:35.753478');
INSERT INTO public.guideline_links VALUES (114, 36, 'https://research.checkpoint.com/2021/the-need-to-protect-public-aws-ssm-documents-what-the-research-shows/', 'CHECK POINT(2021, 05) - AWS SSM 문서의 공개 설정 위험성 분석 및 데이터 노출 방지 대책', NULL, '2025-10-20 16:35:21.943772');
INSERT INTO public.guideline_links VALUES (115, 36, 'https://ramimac.me/ssm-command-docs', 'High Signal Security(2024, 06) - 공개 SSM 명령 문서(Command Documents)를 통한 민감 정보 및 접근 키 노출', NULL, '2025-10-20 16:35:21.947361');
INSERT INTO public.guideline_links VALUES (116, 36, 'https://hackernoon.com/how-aws-misconception-resulted-in-detection-of-5-million-personal-records', 'Hackernoon(2022, 01) - AWS SSM 문서 공유 : 500만 건 개인 정보 유출 사례 분석 및 보안 방안', NULL, '2025-10-20 16:35:21.951233');
INSERT INTO public.guideline_links VALUES (117, 37, 'https://aws.github.io/aws-security-services-best-practices/guides/guardduty/', 'AWS Security Services Best Practices - AWS 클라우드 위협 탐지를 위한 GuardDuty 활용 가이드', NULL, '2025-10-20 16:36:15.941777');
INSERT INTO public.guideline_links VALUES (118, 37, 'https://github.com/aws-samples/aws-incident-response-playbooks/tree/master/playbooks', 'aws-incident-response-playbooks - GuardDuty 미설정으로 인한 인시던트', NULL, '2025-10-20 16:36:15.947494');
INSERT INTO public.guideline_links VALUES (119, 37, 'https://veriti.ai/blog/inside-amazon-guardduty-what-the-logs-reveal-about-cloud-security', 'Veriti Research(2025, 02) - Amazon GuardDuty 로그 기반 클라우드 보안 위협 분석 및 통찰', NULL, '2025-10-20 16:36:15.951929');
INSERT INTO public.guideline_links VALUES (122, 39, 'https://hackingthe.cloud/aws/exploitation/cognito_user_self_signup/', 'Hacking The Cloud(2023, 06) - 의도하지 않은 Cognito의 Self-Signup', NULL, '2025-10-20 16:38:32.127102');
INSERT INTO public.guideline_links VALUES (123, 39, 'https://security.theodo.com/en/blog/aws-cognito-pentest', 'theodo(2023, 07) - Self Sign-up 악용 및 임시 자격증명 탈취', NULL, '2025-10-20 16:38:32.133163');
INSERT INTO public.guideline_links VALUES (124, 38, 'https://hackingthe.cloud/aws/exploitation/cognito_identity_pool_excessive_privileges/', 'Hacking The Cloud(2023, 06) - Cognito Identity Pool의 과도한 권한 설정', NULL, '2025-10-20 16:38:43.38004');
INSERT INTO public.guideline_links VALUES (125, 38, 'https://blog.appsecco.com/exploiting-weak-configurations-in-amazon-cognito-in-aws-471ce761963', 'Appsecco(2021, 04) - Amazon Cognito 취약한 구성을 이용한 임시 AWS 자격증명 확보 및 악용', NULL, '2025-10-20 16:38:43.387756');
INSERT INTO public.guideline_links VALUES (126, 40, 'https://security.theodo.com/en/blog/aws-cognito-pentest', 'Flickr(2021, 12) - Cognito user 이메일 속성 변경으로 인한 계정 탈취', NULL, '2025-10-20 16:39:34.485858');
INSERT INTO public.guideline_links VALUES (127, 40, 'https://medium.com/@mukundbhuva/account-takeover-due-to-cognito-misconfiguration-earns-me-xxxx-3a7b8bb9a619', 'Medium(2022, 12) - Cognito 설정 오류로 인한 계정 탈취 및 정보 접근', NULL, '2025-10-20 16:39:34.489077');
INSERT INTO public.guideline_links VALUES (128, 41, 'https://www.prodefense.io/blog/aws-cloudformation-takeover?utm_source', 'ProDefense(2023, 02) - CloudFormation 스택 생성 권한을 악용한 권한 상승 공격 분석', NULL, '2025-10-20 16:40:53.070798');
INSERT INTO public.guideline_links VALUES (129, 41, 'https://docs.datadoghq.com/ko/security/code_security/iac_security/iac_rules/terraform/aws/role_with_privilege_escalation_by_actions_iam_passrole_and_cloudformation_createstack/?utm_source', 'Datadog - AWS CloudFormation 및 PassRole 설정으로 인한 IAM 권한 에스컬레이션 방지', NULL, '2025-10-20 16:40:53.075909');
INSERT INTO public.guideline_links VALUES (130, 41, 'https://infosecwriteups.com/passing-a-role-to-cloudformation-to-escalate-privileges-602010d26f55', 'Medium(2022, 09) - AWS CloudFormation 역할 전달(iam:PassRole) 취약점을 이용한 권한 상승 공격 분석', NULL, '2025-10-20 16:40:53.079748');
INSERT INTO public.guideline_links VALUES (131, 41, 'https://blog.prodefense.io/how-abusing-aws-cloudformation-led-to-a-total-takeover-of-an-aws-environment-7f94cabd671d', 'Medium(2023, 07) - CloudFormation과 iam:PassRole 권한 남용을 통한 관리자 사용자 생성 공격', NULL, '2025-10-20 16:40:53.085818');
INSERT INTO public.guideline_links VALUES (132, 42, 'https://www.clouddefense.ai/compliance-rules/aws-fs-practices/opensearch/opensearch-in-vpc-only', 'CloudDefense.AI -  AWS OpenSearch 도메인에 대한 최소 권한 기반 접근 통제 구현', NULL, '2025-10-20 16:41:37.269563');
INSERT INTO public.guideline_links VALUES (133, 42, 'https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/Elasticsearch/domain-exposed.html', 'TrendMirco - AWS OpenSearch 서비스: 공개 도메인 노출 위험과 액세스 정책 강화 방안', NULL, '2025-10-20 16:41:37.273106');
INSERT INTO public.guideline_links VALUES (134, 43, 'https://rhinosecuritylabs.com/tools/new-pacu-module-enumerating-elastic-beanstalk/', 'RHINO - Pacu 모듈로 Elastic Beanstalk 시크릿 열거', NULL, '2025-10-20 16:42:31.699608');
INSERT INTO public.guideline_links VALUES (135, 43, 'https://medium.com/%40mauzware/day-6-of-my-aws-pentesting-journey-exploring-elastic-beanstalk-adc28ea74f0d', 'Medium(2025, 05) - Pacu 모듈을 통한 Beanstalk 내부 하드코딩 시크릿 탐지', NULL, '2025-10-20 16:42:31.706114');
INSERT INTO public.guideline_links VALUES (136, 43, 'https://aws.plainenglish.io/hacking-aws-beanstalk-cloudgoat-scenario-4da1fac6a4cf', 'Medium(2025, 06) - AWS Beanstalk 보안: 환경 변수 내 민감 정보 저장을 통한 계정 전체 탈취 경로', NULL, '2025-10-20 16:42:31.712483');
INSERT INTO public.guideline_links VALUES (137, 44, 'https://www.fogsecurity.io/blog/shifty-business-redshift-encryption-aws', 'fogsecurity(2025, 04) - AWS Redshift의 암호화 기본 설정 우회 및 보안 감사 미비점 분석', NULL, '2025-10-20 16:43:41.177602');
INSERT INTO public.guideline_links VALUES (138, 44, 'https://aws.amazon.com/ko/blogs/security/amazon-redshift-enhances-security-by-changing-default-behavior-in-2025/', 'AWS Security Blog(2025, 01) - Redshift 기본 보안 강화', NULL, '2025-10-20 16:43:41.180361');
INSERT INTO public.guideline_links VALUES (139, 45, 'https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/', 'Hacking The Cloud (2021, 11) - AWS IAM 권한 상승 공격 기법 분석', NULL, '2025-10-20 16:44:33.287793');
INSERT INTO public.guideline_links VALUES (140, 45, 'https://docs.kics.io/develop/queries/terraform-queries/aws/94fbe150-27e3-4eba-9ca6-af32865e4503/', 'KICS - AWS Glue 개발 엔드포인트 생성 권한을 악용한 IAM 권한 에스컬레이션 방지', NULL, '2025-10-20 16:44:33.291232');
INSERT INTO public.guideline_links VALUES (141, 45, 'https://bishopfox.com/blog/5-privesc-attack-vectors-in-aws', 'BISHOPFOX(2019, 12) - AWS Glue 개발 엔드포인트 수정 권한을 이용한 권한 상승 위험', NULL, '2025-10-20 16:44:33.294545');
INSERT INTO public.guideline_links VALUES (142, 46, 'https://www.slideshare.net/secret/56jgTgG070ec4j', 'DEF CON 31(2023, 08) - Service Catalog 관리자 권한을 이용한 권한 상승 취약점', NULL, '2025-10-20 16:45:26.445827');
INSERT INTO public.guideline_links VALUES (143, 46, 'https://docs.aws.amazon.com/servicecatalog/latest/adminguide/constraints-launch.html', 'AWS Docs - AWS Service Catalog Launch Constraint을 활용한 최소 권한 구현', NULL, '2025-10-20 16:45:26.452172');
INSERT INTO public.guideline_links VALUES (144, 47, 'https://ramimac.me/exposed-docdb', 'High Signal Security(2024, 05) - AWS DocumentDB 스냅샷 공개 노출 위험 및 대규모 고객 데이터 유출 사례 분석', NULL, '2025-10-20 16:46:35.892816');
INSERT INTO public.guideline_links VALUES (145, 47, 'https://docs.aws.amazon.com/documentdb/latest/developerguide/backup_restore-share_cluster_snapshots.html?utm_source=chatgpt.com', 'AWS Developer Guide - Amazon DocumentDB: 클러스터 스냅샷 공유 및 복원 가이드', NULL, '2025-10-20 16:46:35.895907');
INSERT INTO public.guideline_links VALUES (157, 24, 'https://www.sysdig.com/blog/aws-rds-security-events-sysdig', 'sysdig(2022, 05) - RDS 인스턴스를 공개로 설정', NULL, '2025-10-20 17:49:36.053283');
INSERT INTO public.guideline_links VALUES (158, 24, 'https://www.blinkops.com/blog/tracking-down-amazon-rds-instances-that-are-publicly-accessible', 'BlinkOps(2022, 02) - 공개적으로 접근 가능한 RDS 인스턴스를 추적하는 방법', NULL, '2025-10-20 17:49:36.057059');
INSERT INTO public.guideline_links VALUES (159, 20, 'https://www.wired.com/story/cryptojacking-tesla-amazon-cloud/', 'Tesla(2018, 02) - 배스천 호스트 미사용으로 인한 ec2 크립토마이닝', NULL, '2025-10-20 21:18:09.267386');
INSERT INTO public.guideline_links VALUES (160, 20, 'https://www.boannews.com/media/view.asp?idx=122816&direct=mobile', 'QubitStrike(2023, 08) -  ec2에 설치된 Jupeternote의 취약점을 이용한 크립토마이', NULL, '2025-10-20 21:18:09.275955');


--
-- Data for Name: guideline_solution_images; Type: TABLE DATA; Schema: public; Owner: -
--



--
-- Data for Name: refresh_tokens; Type: TABLE DATA; Schema: public; Owner: -
--

INSERT INTO public.refresh_tokens VALUES (15, 6, 'eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJsZWVqZWh3YW4iLCJ1c2VySWQiOjYsInJvbGUiOiJVU0VSIiwiZnVsbE5hbWUiOiLsnbTsoJztmZgiLCJlbWFpbCI6InJpY2htYW5samhAbmF2ZXIuY29tIiwidGltZXN0YW1wIjoxNzYwOTM1MDA1NjAwLCJpYXQiOjE3NjA5MzUwMDUsImV4cCI6MTc2MDkzODYwNX0.4GVeGsiXWe2JdzUC04WvgmeMP6NPBPagpodkddzetMQ', 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36', '2025-10-20 14:36:45.600386', '2025-10-20 13:36:45.600603');
INSERT INTO public.refresh_tokens VALUES (21, 5, 'eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJoeW9qdTIyNTkiLCJ1c2VySWQiOjUsInJvbGUiOiJVU0VSIiwiZnVsbE5hbWUiOiLquYDtmqjso7wiLCJlbWFpbCI6Imh5b2p1MjI1OUBuYXZlci5jb20iLCJ0aW1lc3RhbXAiOjE3NjA5MzY2MzgxMTcsImlhdCI6MTc2MDkzNjYzOCwiZXhwIjoxNzYwOTQwMjM4fQ.2WV1Cis9KPdDgl3OrIQD8UvFOc6LwnlY8W2yJa8d_Jc', 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36', '2025-10-20 15:03:58.11826', '2025-10-20 14:03:58.118838');
INSERT INTO public.refresh_tokens VALUES (49, 1, 'eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1c2VyIiwidXNlcklkIjoxLCJyb2xlIjoiVVNFUiIsImZ1bGxOYW1lIjoi7JWI64WVIiwiZW1haWwiOiJ1c2VyQG5hdmVyLmNvbSIsInRpbWVzdGFtcCI6MTc2MDk0MjczNjkxOSwiaWF0IjoxNzYwOTQyNzM2LCJleHAiOjE3NjA5NDYzMzZ9.D6y5FgBXOs1N9Le9G4O-XpSeCaBwux2yaqWH1P6dbBk', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/141.0.0.0 Safari/537.36', '2025-10-20 16:45:36.920073', '2025-10-20 15:45:36.928504');
INSERT INTO public.refresh_tokens VALUES (53, 2, 'eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbjEiLCJ1c2VySWQiOjIsInJvbGUiOiJBRE1JTiIsImZ1bGxOYW1lIjoiYWRtaW4xIiwiZW1haWwiOiJhZG1pbjFAYWRtaW4iLCJ0aW1lc3RhbXAiOjE3NjA5NjI2NDc1NjYsImlhdCI6MTc2MDk2MjY0NywiZXhwIjoxNzYwOTY2MjQ3fQ.W_D4EdbArg6Opg7xAjYgiLovMxHZCGfgnWc6R_LNF0w', 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.6 Safari/605.1.15', '2025-10-20 22:17:27.566367', '2025-10-20 21:17:27.566509');


--
-- Data for Name: user_checklist_results; Type: TABLE DATA; Schema: public; Owner: -
--



--
-- Data for Name: user_checklist_item_results; Type: TABLE DATA; Schema: public; Owner: -
--



--
-- Name: checklists_id_seq; Type: SEQUENCE SET; Schema: public; Owner: -
--

SELECT pg_catalog.setval('public.checklists_id_seq', 62, true);


--
-- Name: cloud_providers_id_seq; Type: SEQUENCE SET; Schema: public; Owner: -
--

SELECT pg_catalog.setval('public.cloud_providers_id_seq', 3, true);


--
-- Name: guideline_links_id_seq; Type: SEQUENCE SET; Schema: public; Owner: -
--

SELECT pg_catalog.setval('public.guideline_links_id_seq', 160, true);


--
-- Name: guideline_solution_images_id_seq; Type: SEQUENCE SET; Schema: public; Owner: -
--

SELECT pg_catalog.setval('public.guideline_solution_images_id_seq', 1, false);


--
-- Name: guidelines_id_seq; Type: SEQUENCE SET; Schema: public; Owner: -
--

SELECT pg_catalog.setval('public.guidelines_id_seq', 51, true);


--
-- Name: refresh_tokens_id_seq; Type: SEQUENCE SET; Schema: public; Owner: -
--

SELECT pg_catalog.setval('public.refresh_tokens_id_seq', 53, true);


--
-- Name: service_lists_id_seq; Type: SEQUENCE SET; Schema: public; Owner: -
--

SELECT pg_catalog.setval('public.service_lists_id_seq', 27, true);


--
-- Name: user_checklist_item_results_id_seq; Type: SEQUENCE SET; Schema: public; Owner: -
--

SELECT pg_catalog.setval('public.user_checklist_item_results_id_seq', 1, false);


--
-- Name: user_checklist_results_id_seq; Type: SEQUENCE SET; Schema: public; Owner: -
--

SELECT pg_catalog.setval('public.user_checklist_results_id_seq', 1, false);


--
-- Name: users_id_seq; Type: SEQUENCE SET; Schema: public; Owner: -
--

SELECT pg_catalog.setval('public.users_id_seq', 6, true);


--
-- PostgreSQL database dump complete
--

